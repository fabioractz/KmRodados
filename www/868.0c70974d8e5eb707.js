"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[868],{868(B,f,l){l.d(f,{HistoryPageModule:()=>V});var p=l(2200),y=l(4341),d=l(7343),_=l(8132),u=l(467),v=l(2855),P=l(7949),C=l(3085),t=l(3664),h=l(2615),b=l(9198),F=l(6991),M=l(5355);const x=(n,s,a,e,o)=>({"caixa-icone-abastecimento":n,"caixa-icone-manutencao":s,"caixa-icone-consumo":a,"caixa-icone-viagem":e,"caixa-icone-veiculo":o}),A=()=>["supply","maintenance","consumption","vehicle-add"];function k(n,s){if(1&n&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const a=t.XpG().$implicit;t.R7$(),t.E5c(" ",a.data.gasStation?a.data.gasStation+" - ":""," ",t.i5U(2,3,a.data.totalValue,"BRL")," (",a.data.liters,"L) ")}}function H(n,s){if(1&n&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"number"),t.k0s()),2&n){const a=t.XpG().$implicit;t.R7$(),t.Lme(" M\xe9dia: ",t.i5U(2,2,a.data.result,"1.2-2")," km/l (",a.data.distance,"km) ")}}function E(n,s){if(1&n&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const a=t.XpG().$implicit;t.R7$(),t.Lme(" ",a.data.summary," - ",t.i5U(2,2,a.data.totalValue,"BRL")," ")}}function R(n,s){if(1&n&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const a=t.XpG().$implicit;t.R7$(),t.Lme(" Viagem: ",a.data.distance,"km - Custo: ",t.i5U(2,2,a.data.totalCost,"BRL")," ")}}function $(n,s){if(1&n&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"uppercase"),t.k0s()),2&n){const a=t.XpG().$implicit;t.R7$(),t.Lme(" Ve\xedculo Adicionado: ",a.data.model," (",t.bMT(2,2,a.data.plate),") ")}}function j(n,s){if(1&n){const a=t.RV6();t.j41(0,"ion-button",20),t.bIt("click",function(){h.eBV(a);const o=t.XpG().$implicit,i=t.XpG();return h.Njj(i.editar_item_historico(o))}),t.nrm(1,"ion-icon",21),t.k0s()}}function T(n,s){if(1&n&&(t.j41(0,"ion-item",15)(1,"div",16),t.nrm(2,"ion-icon",17),t.k0s(),t.j41(3,"ion-label")(4,"h2"),t.EFF(5),t.nI1(6,"date"),t.j41(7,"span",18),t.EFF(8),t.k0s()(),t.DNE(9,k,3,6,"p",14)(10,H,3,5,"p",14)(11,E,3,5,"p",14)(12,R,3,5,"p",14)(13,$,3,4,"p",14),t.k0s(),t.DNE(14,j,2,0,"ion-button",19),t.k0s()),2&n){const a=s.$implicit,e=t.XpG();t.R7$(),t.Y8G("ngClass",t.s1E(14,x,"supply"===a.type,"maintenance"===a.type,"consumption"===a.type,"trip"===a.type,"vehicle-add"===a.type)),t.R7$(),t.Y8G("name",e.obter_icone_item_historico(a)),t.R7$(3),t.Lme(" ",t.i5U(6,11,a.date,"dd/MM/yyyy")," - ",a.vehicle.model," "),t.R7$(3),t.SpI("(",e.obter_rotulo_tipo_item(a),")"),t.R7$(),t.Y8G("ngIf","supply"===a.type),t.R7$(),t.Y8G("ngIf","consumption"===a.type),t.R7$(),t.Y8G("ngIf","maintenance"===a.type),t.R7$(),t.Y8G("ngIf","trip"===a.type),t.R7$(),t.Y8G("ngIf","vehicle-add"===a.type),t.R7$(),t.Y8G("ngIf",t.lJ4(20,A).includes(a.type))}}function I(n,s){1&n&&(t.j41(0,"ion-item")(1,"ion-label",22),t.EFF(2,"Nenhum registro encontrado"),t.k0s()())}const G=[{path:"",component:(()=>{var n;class s{constructor(e,o,i,r){this.servicoVeiculos=e,this.roteador=o,this.controladorModal=i,this.ajuda_odometro=r,this.veiculos=[],this.historicoCompleto=[],this.historicoCompleto_bruto=[],this.criterio_ordenacao="data_recente"}ngOnInit(){this.servicoVeiculos.getVehicles().subscribe(e=>{this.veiculos=e,this.atualizar_historico_completo()})}atualizar_historico_completo(){const e=[];this.veiculos.forEach(o=>{o.supplies&&o.supplies.forEach(i=>{e.push({type:"supply",date:new Date(i.date),createdAt:i.createdAt||0,vehicle:o,data:i})}),o.consumptionHistory&&o.consumptionHistory.forEach(i=>{e.push({type:"consumption",date:new Date(i.date),createdAt:i.createdAt||0,vehicle:o,data:i})}),o.maintenance&&o.maintenance.forEach(i=>{e.push({type:"maintenance",date:new Date(i.date),createdAt:i.createdAt||0,vehicle:o,data:i})}),o.trips&&o.trips.forEach(i=>{e.push({type:"trip",date:new Date(i.date),createdAt:i.createdAt||0,vehicle:o,data:i})}),o.createdAt&&e.push({type:"vehicle-add",date:new Date(o.createdAt),createdAt:o.createdAt,vehicle:o,data:{model:o.model,plate:o.plate}})}),this.historicoCompleto_bruto=e,this.aplicar_ordenacao()}aplicar_ordenacao(){const e=[...this.historicoCompleto_bruto];this.historicoCompleto="data_recente"===this.criterio_ordenacao?e.sort((o,i)=>{const r=o.date.getTime(),c=i.date.getTime();return r!==c?c-r:i.createdAt-o.createdAt}):"data_antiga"===this.criterio_ordenacao?e.sort((o,i)=>{const r=o.date.getTime(),c=i.date.getTime();return r!==c?r-c:o.createdAt-i.createdAt}):"alfabetica_az"===this.criterio_ordenacao?e.sort((o,i)=>{const r=(o.vehicle.model||"").toLocaleLowerCase(),c=(i.vehicle.model||"").toLocaleLowerCase();if(r<c)return-1;if(r>c)return 1;const m=o.date.getTime();return i.date.getTime()-m}):"alfabetica_za"===this.criterio_ordenacao?e.sort((o,i)=>{const r=(o.vehicle.model||"").toLocaleLowerCase(),c=(i.vehicle.model||"").toLocaleLowerCase();if(r<c)return 1;if(r>c)return-1;const m=o.date.getTime();return i.date.getTime()-m}):"tipo"===this.criterio_ordenacao?e.sort((o,i)=>{const r=o.type,c=i.type;if(r<c)return-1;if(r>c)return 1;const m=o.date.getTime();return i.date.getTime()-m}):e}alterar_criterio_ordenacao(e){"data_recente"!==e&&"data_antiga"!==e&&"alfabetica_az"!==e&&"alfabetica_za"!==e&&"tipo"!==e||(this.criterio_ordenacao=e,this.aplicar_ordenacao())}obter_nome_tipo_veiculo(e){return this.servicoVeiculos.getVehicleTypeName(e.type)}obter_rotulo_tipo_item(e){return"supply"===e.type?"Abastecimento":"maintenance"===e.type?"Manuten\xe7\xe3o":this.obter_nome_tipo_veiculo(e.vehicle)}obter_icone_tipo_veiculo(e){return this.servicoVeiculos.getVehicleIcon(e.type)}abrir_modal_abastecimento(e,o){var i=this;return(0,u.A)(function*(){const r=yield i.controladorModal.create({component:v.K,componentProps:{vehicles:i.veiculos,editingSupply:e,editingVehiclePlate:o}});yield r.present();const{data:c}=yield r.onWillDismiss();c&&"view_history"===c.action&&i.roteador.navigate(["/supply-history"])})()}abrir_modal_consumo(e,o){var i=this;return(0,u.A)(function*(){const r=yield i.controladorModal.create({component:P.u,componentProps:{vehicles:i.veiculos,editingRecord:e,editingVehiclePlate:o}});yield r.present();const{data:c}=yield r.onWillDismiss();c&&"view_history"===c.action&&i.roteador.navigate(["/consumption-history"])})()}abrir_modal_manutencao(e,o){var i=this;return(0,u.A)(function*(){const r=yield i.controladorModal.create({component:C.O,componentProps:{vehicles:i.veiculos,editingMaintenance:e,editingVehiclePlate:o}});yield r.present();const{data:c}=yield r.onWillDismiss();c&&"view_history"===c.action&&i.roteador.navigate(["/maintenance-history"])})()}obter_icone_historico(e){switch(e){case"supply":return"gas-station";case"consumption":return"speedometer";case"maintenance":return"construct";case"trip":return"map";default:return"car"}}obter_icone_item_historico(e){return"vehicle-add"===e.type?this.servicoVeiculos.getVehicleIcon(e.vehicle.type):this.obter_icone_historico(e.type)}obter_cor_historico(e){switch(e){case"supply":return"success";case"consumption":return"dark";case"maintenance":return"danger";case"trip":return"warning";case"vehicle-add":return"tertiary";default:return"medium"}}editar_item_historico(e){var o=this;return(0,u.A)(function*(){"supply"===e.type?yield o.abrir_modal_abastecimento(e.data,e.vehicle.plate):"maintenance"===e.type?yield o.abrir_modal_manutencao(e.data,e.vehicle.plate):"consumption"===e.type?yield o.abrir_modal_consumo(e.data,e.vehicle.plate):"vehicle-add"===e.type&&o.roteador.navigate(["/tabs/vehicles/form",e.vehicle.plate])})()}}return(n=s).\u0275fac=function(e){return new(e||n)(t.rXU(b.K),t.rXU(F.Ix),t.rXU(d.W3),t.rXU(M.k))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-history"]],standalone:!1,decls:26,vars:5,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],["lines","full",1,"item-ordenacao"],["slot","end",1,"texto-ordenar-por"],["slot","end","interface","popover",3,"ionChange","value"],["value","data_recente"],["value","data_antiga"],["value","alfabetica_az"],["value","alfabetica_za"],["value","tipo"],["lines","none",1,"lista-historico"],["class","item-historico",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"item-historico"],["slot","start",1,"caixa-icone-historico",3,"ngClass"],[3,"name"],[1,"tipo-veiculo"],["slot","end","fill","clear",3,"click",4,"ngIf"],["slot","end","fill","clear",3,"click"],["name","create","slot","icon-only"],[1,"ion-text-center"]],template:function(e,o){1&e&&(t.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Hist\xf3rico"),t.k0s()()(),t.j41(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),t.EFF(8,"Hist\xf3rico"),t.k0s()()(),t.j41(9,"ion-item",4)(10,"ion-label",5),t.EFF(11,"Ordenar por"),t.k0s(),t.j41(12,"ion-select",6),t.bIt("ionChange",function(r){return o.alterar_criterio_ordenacao(r.detail.value)}),t.j41(13,"ion-select-option",7),t.EFF(14,"Data (mais recentes primeiro)"),t.k0s(),t.j41(15,"ion-select-option",8),t.EFF(16,"Data (mais antigos primeiro)"),t.k0s(),t.j41(17,"ion-select-option",9),t.EFF(18,"Nome (A-Z)"),t.k0s(),t.j41(19,"ion-select-option",10),t.EFF(20,"Nome (Z-A)"),t.k0s(),t.j41(21,"ion-select-option",11),t.EFF(22,"Tipo"),t.k0s()()(),t.j41(23,"ion-list",12),t.DNE(24,T,15,21,"ion-item",13)(25,I,3,0,"ion-item",14),t.k0s()()),2&e&&(t.Y8G("translucent",!0),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(8),t.Y8G("value",o.criterio_ordenacao),t.R7$(12),t.Y8G("ngForOf",o.historicoCompleto),t.R7$(),t.Y8G("ngIf",0===o.historicoCompleto.length))},dependencies:[p.YU,p.Sq,p.bT,d.Jm,d.W9,d.eU,d.iq,d.uz,d.he,d.nf,d.Nm,d.Ip,d.BC,d.ai,d.Je,p.Pc,p.QX,p.oe,p.vh],styles:["ion-content[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0}.texto-ordenar-por[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium);margin-right:8px}.item-ordenacao[_ngcontent-%COMP%]{--inner-padding-start: 8px;--inner-padding-end: 16px}.lista-historico[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(2n){--background: rgba(0, 0, 0, .02)}.lista-historico[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 8px}.tipo-veiculo[_ngcontent-%COMP%]{font-size:.85rem;color:var(--ion-color-medium);margin-left:4px}.caixa-icone-historico[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.caixa-icone-historico[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.4rem;color:#fff}.caixa-icone-abastecimento[_ngcontent-%COMP%]{background-color:var(--ion-color-success-shade)}.caixa-icone-manutencao[_ngcontent-%COMP%]{background-color:var(--ion-color-danger-shade)}.caixa-icone-consumo[_ngcontent-%COMP%]{background-color:var(--ion-color-dark-shade)}.caixa-icone-viagem[_ngcontent-%COMP%]{background-color:var(--ion-color-warning-shade)}.caixa-icone-veiculo[_ngcontent-%COMP%]{background-color:var(--ion-color-tertiary-shade)}"]}),s})()}];let O=(()=>{var n;class s{}return(n=s).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=h.G2t({imports:[_.iI.forChild(G),_.iI]}),s})(),V=(()=>{var n;class s{}return(n=s).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=h.G2t({imports:[p.MD,y.YN,d.bv,O]}),s})()}}]);