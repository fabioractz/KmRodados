"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5699],{5699(Z,x,u){u.d(x,{CalculatorPageModule:()=>W});var p=u(2200),k=u(4341),r=u(7343),v=u(8132),b=u(467),V=u(5079),m=u(5873),t=u(3664),o=u(2615),I=u(9198),P=u(2122),y=u(7298),E=u(5355);function D(a,c){if(1&a){const n=t.RV6();t.j41(0,"ion-buttons",8)(1,"ion-button",9),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setView("menu"))}),t.nrm(2,"ion-icon",10),t.k0s()()}}function R(a,c){if(1&a){const n=t.RV6();t.j41(0,"div",11)(1,"div",12),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setView("consumption"))}),t.nrm(2,"ion-icon",13),t.j41(3,"label"),t.EFF(4,"Calcular Consumo"),t.k0s()(),t.j41(5,"div",12),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setView("trip"))}),t.nrm(6,"ion-icon",14),t.j41(7,"label"),t.EFF(8,"Calcular Viagem"),t.k0s()(),t.j41(9,"div",12),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setView("simple"))}),t.nrm(10,"ion-icon",15),t.j41(11,"label"),t.EFF(12,"Calculadora"),t.k0s()()()}}function M(a,c){if(1&a&&(t.j41(0,"ion-select-option",28),t.EFF(1),t.nI1(2,"uppercase"),t.k0s()),2&a){const n=c.$implicit;t.Y8G("value",n),t.R7$(),t.Lme(" ",n.model," (",t.bMT(2,3,n.plate),") ")}}function O(a,c){if(1&a){const n=t.RV6();t.j41(0,"ion-datetime",29),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG(2);return t.DH7(l.tripDate,e)||(l.tripDate=e),o.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG(2);t.R50("ngModel",n.tripDate)}}function N(a,c){if(1&a&&(t.j41(0,"ion-item")(1,"ion-label")(2,"p"),t.EFF(3,"Consumo do Ve\xedculo"),t.k0s(),t.j41(4,"h2"),t.EFF(5),t.k0s()()()),2&a){const n=t.XpG(2);t.R7$(5),t.SpI("",n.selectedVehicle.consumption," km/L")}}function G(a,c){if(1&a){const n=t.RV6();t.j41(0,"ion-card",30)(1,"ion-card-header")(2,"ion-card-title"),t.EFF(3,"Resultado"),t.k0s()(),t.j41(4,"ion-card-content")(5,"h2"),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.j41(8,"p"),t.EFF(9),t.nI1(10,"number"),t.k0s(),t.j41(11,"ion-button",31),t.bIt("click",function(){o.eBV(n);const e=t.XpG(2);return o.Njj(e.saveTrip())}),t.EFF(12),t.k0s()()()}if(2&a){const n=t.XpG(2);t.R7$(6),t.SpI("Custo Estimado: ",t.i5U(7,3,n.result,"BRL")),t.R7$(3),t.SpI("Litros necess\xe1rios: ",t.i5U(10,6,n.litersNeeded,"1.1-2")," L"),t.R7$(3),t.SpI(" ",n.isEditing?"Atualizar Viagem":"Salvar Viagem"," ")}}function T(a,c){if(1&a){const n=t.RV6();t.j41(0,"div")(1,"div",16)(2,"p"),t.EFF(3,"Calcule quanto voc\xea vai gastar na sua viagem."),t.k0s()(),t.j41(4,"ion-list")(5,"ion-item")(6,"ion-select",17),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.selectedVehicle,e)||(l.selectedVehicle=e),o.Njj(e)}),t.bIt("ionChange",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.onVehicleChange())}),t.DNE(7,M,3,5,"ion-select-option",18),t.k0s()(),t.j41(8,"ion-item")(9,"ion-label",19),t.EFF(10,"Data"),t.k0s(),t.nrm(11,"ion-datetime-button",20),t.j41(12,"ion-modal",21),t.DNE(13,O,1,1,"ng-template"),t.k0s()(),t.j41(14,"ion-item")(15,"ion-input",22),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.distance,e)||(l.distance=e),o.Njj(e)}),t.k0s()(),t.j41(16,"ion-item")(17,"ion-input",23),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.fuelPriceStr,e)||(l.fuelPriceStr=e),o.Njj(e)}),t.bIt("ionInput",function(e){o.eBV(n);const l=t.XpG();return o.Njj(l.formatCurrency(e))}),t.k0s()(),t.j41(18,"ion-item")(19,"ion-textarea",24),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.costObservations,e)||(l.costObservations=e),o.Njj(e)}),t.k0s()(),t.DNE(20,N,6,1,"ion-item",6),t.k0s(),t.j41(21,"ion-button",25),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.calculate())}),t.EFF(22," Calcular Custo "),t.k0s(),t.j41(23,"ion-button",26),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setHistoryOpen(!0))}),t.EFF(24," Hist\xf3rico "),t.k0s(),t.DNE(25,G,13,9,"ion-card",27),t.k0s()}if(2&a){const n=t.XpG();t.R7$(6),t.R50("ngModel",n.selectedVehicle),t.R7$(),t.Y8G("ngForOf",n.vehicles),t.R7$(5),t.Y8G("keepContentsMounted",!0),t.R7$(3),t.R50("ngModel",n.distance),t.R7$(2),t.R50("ngModel",n.fuelPriceStr),t.R7$(2),t.R50("ngModel",n.costObservations),t.R7$(),t.Y8G("ngIf",n.selectedVehicle),t.R7$(5),t.Y8G("ngIf",null!==n.result)}}function w(a,c){if(1&a&&(t.j41(0,"ion-select-option",28),t.EFF(1),t.k0s()),2&a){const n=c.$implicit;t.Y8G("value",n.plate),t.R7$(),t.Lme("",n.model," (",n.plate,")")}}function X(a,c){if(1&a){const n=t.RV6();t.j41(0,"ion-datetime",40),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG(2);return t.DH7(l.calcDate,e)||(l.calcDate=e),o.Njj(e)}),t.k0s()}if(2&a){const n=t.XpG(2);t.R50("ngModel",n.calcDate)}}function B(a,c){if(1&a){const n=t.RV6();t.j41(0,"div")(1,"div",16)(2,"p"),t.EFF(3,"Descubra a m\xe9dia de consumo do seu ve\xedculo."),t.k0s()(),t.j41(4,"ion-list")(5,"ion-item")(6,"ion-select",32),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.calcSelectedVehicle,e)||(l.calcSelectedVehicle=e),o.Njj(e)}),t.DNE(7,w,2,3,"ion-select-option",18),t.k0s()(),t.j41(8,"ion-item")(9,"ion-label",19),t.EFF(10,"Data"),t.k0s(),t.nrm(11,"ion-datetime-button",33),t.j41(12,"ion-modal",21),t.DNE(13,X,1,1,"ng-template"),t.k0s()(),t.j41(14,"ion-item")(15,"ion-label",19),t.EFF(16," Od\xf4metro Inicial (km) "),t.j41(17,"span",34),t.bIt("click",function(e){o.eBV(n);const l=t.XpG();return o.Njj(l.ajuda_odometro.mostrarAjudaOdometro(e))}),t.EFF(18,"?"),t.k0s()(),t.j41(19,"ion-input",35),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.calcInitialOdometer,e)||(l.calcInitialOdometer=e),o.Njj(e)}),t.bIt("ionChange",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.updateDistance())}),t.k0s()(),t.j41(20,"ion-item")(21,"ion-label",19),t.EFF(22," Od\xf4metro Final (km) "),t.j41(23,"span",34),t.bIt("click",function(e){o.eBV(n);const l=t.XpG();return o.Njj(l.ajuda_odometro.mostrarAjudaOdometro(e))}),t.EFF(24,"?"),t.k0s()(),t.j41(25,"ion-input",35),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.calcFinalOdometer,e)||(l.calcFinalOdometer=e),o.Njj(e)}),t.bIt("ionChange",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.updateDistance())}),t.k0s()(),t.j41(26,"ion-item")(27,"ion-input",36),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.calcDist,e)||(l.calcDist=e),o.Njj(e)}),t.k0s()(),t.j41(28,"ion-item")(29,"ion-input",37),t.mxI("ngModelChange",function(e){o.eBV(n);const l=t.XpG();return t.DH7(l.calcLiters,e)||(l.calcLiters=e),o.Njj(e)}),t.bIt("ionChange",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.calculateConsumption())}),t.k0s()(),t.j41(30,"ion-item",38)(31,"ion-label")(32,"h2"),t.EFF(33,"M\xe9dia de Consumo"),t.k0s(),t.j41(34,"p",39),t.EFF(35),t.nI1(36,"number"),t.k0s()()()(),t.j41(37,"ion-button",25),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.saveConsumption())}),t.EFF(38," Salvar "),t.k0s(),t.j41(39,"ion-button",26),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setHistoryOpen(!0))}),t.EFF(40," Hist\xf3rico "),t.k0s()()}if(2&a){const n=t.XpG();t.R7$(6),t.R50("ngModel",n.calcSelectedVehicle),t.R7$(),t.Y8G("ngForOf",n.vehicles),t.R7$(5),t.Y8G("keepContentsMounted",!0),t.R7$(7),t.R50("ngModel",n.calcInitialOdometer),t.R7$(6),t.R50("ngModel",n.calcFinalOdometer),t.R7$(2),t.R50("ngModel",n.calcDist),t.R7$(2),t.R50("ngModel",n.calcLiters),t.R7$(6),t.SpI(" ",n.calcResult?t.i5U(36,8,n.calcResult,"1.2-2")+" km/l":"--"," ")}}function S(a,c){if(1&a){const n=t.RV6();t.j41(0,"div")(1,"div",41)(2,"div",42),t.EFF(3),t.k0s(),t.j41(4,"div",43)(5,"ion-button",44),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.clearCalculator())}),t.EFF(6,"C"),t.k0s(),t.j41(7,"ion-button",44),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.backspace())}),t.nrm(8,"ion-icon",45),t.k0s(),t.j41(9,"ion-button",44),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.percentage())}),t.EFF(10,"%"),t.k0s(),t.j41(11,"ion-button",46),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setOperation("/"))}),t.EFF(12,"/"),t.k0s(),t.j41(13,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("7"))}),t.EFF(14,"7"),t.k0s(),t.j41(15,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("8"))}),t.EFF(16,"8"),t.k0s(),t.j41(17,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("9"))}),t.EFF(18,"9"),t.k0s(),t.j41(19,"ion-button",46),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setOperation("*"))}),t.EFF(20,"x"),t.k0s(),t.j41(21,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("4"))}),t.EFF(22,"4"),t.k0s(),t.j41(23,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("5"))}),t.EFF(24,"5"),t.k0s(),t.j41(25,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("6"))}),t.EFF(26,"6"),t.k0s(),t.j41(27,"ion-button",46),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setOperation("-"))}),t.EFF(28,"-"),t.k0s(),t.j41(29,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("1"))}),t.EFF(30,"1"),t.k0s(),t.j41(31,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("2"))}),t.EFF(32,"2"),t.k0s(),t.j41(33,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("3"))}),t.EFF(34,"3"),t.k0s(),t.j41(35,"ion-button",46),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setOperation("+"))}),t.EFF(36,"+"),t.k0s(),t.j41(37,"ion-button",48),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("0"))}),t.EFF(38,"0"),t.k0s(),t.j41(39,"ion-button",47),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.appendNumber("."))}),t.EFF(40,"."),t.k0s(),t.j41(41,"ion-button",46),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.calculateResult())}),t.EFF(42,"="),t.k0s()()()()}if(2&a){const n=t.XpG();t.R7$(3),t.JRh(n.calcDisplay)}}function $(a,c){if(1&a){const n=t.RV6();t.j41(0,"ion-item")(1,"ion-label")(2,"h2"),t.EFF(3),t.nI1(4,"date"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s()(),t.j41(9,"ion-note",52),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"ion-button",53),t.bIt("click",function(){const e=o.eBV(n).$implicit,l=t.XpG(3);return o.Njj(l.editHistoryItem(e))}),t.nrm(13,"ion-icon",54),t.k0s()()}if(2&a){const n=c.$implicit;t.R7$(3),t.Lme("",t.i5U(4,5,n.trip.date,"dd/MM/yyyy")," - ",n.vehicle.model),t.R7$(3),t.SpI("Dist\xe2ncia: ",n.trip.distance," km"),t.R7$(2),t.SpI("Consumo: ",n.trip.consumption," km/L"),t.R7$(2),t.SpI(" ",t.i5U(11,8,n.trip.totalCost,"BRL")," ")}}function H(a,c){1&a&&(t.j41(0,"div",55)(1,"p"),t.EFF(2,"Nenhuma viagem registrada."),t.k0s()())}function L(a,c){if(1&a&&(t.j41(0,"ion-list"),t.DNE(1,$,14,11,"ion-item",50)(2,H,3,0,"div",51),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngForOf",n.tripHistory),t.R7$(),t.Y8G("ngIf",0===n.tripHistory.length)}}function Y(a,c){if(1&a&&(t.j41(0,"ion-item")(1,"ion-label")(2,"h2"),t.EFF(3),t.nI1(4,"date"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s()(),t.j41(9,"ion-note",56),t.EFF(10),t.nI1(11,"number"),t.k0s()()),2&a){const n=c.$implicit;t.R7$(3),t.Lme("",t.i5U(4,5,n.record.date,"dd/MM/yyyy")," - ",n.vehicle.model),t.R7$(3),t.SpI("Dist\xe2ncia: ",n.record.distance," km"),t.R7$(2),t.SpI("Litros: ",n.record.liters," L"),t.R7$(2),t.SpI(" ",t.i5U(11,8,n.record.result,"1.2-2")," km/L ")}}function A(a,c){1&a&&(t.j41(0,"div",55)(1,"p"),t.EFF(2,"Nenhum consumo registrado."),t.k0s()())}function z(a,c){if(1&a&&(t.j41(0,"ion-list"),t.DNE(1,Y,12,11,"ion-item",50)(2,A,3,0,"div",51),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngForOf",n.consumptionHistory),t.R7$(),t.Y8G("ngIf",0===n.consumptionHistory.length)}}function U(a,c){if(1&a){const n=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",49)(5,"ion-button",9),t.bIt("click",function(){o.eBV(n);const e=t.XpG();return o.Njj(e.setHistoryOpen(!1))}),t.EFF(6,"Fechar"),t.k0s()()()(),t.j41(7,"ion-content"),t.DNE(8,L,3,2,"ion-list",6)(9,z,3,2,"ion-list",6),t.k0s()}if(2&a){const n=t.XpG();t.R7$(3),t.JRh("trip"===n.currentView?"Hist\xf3rico de Viagens":"Hist\xf3rico de Consumo"),t.R7$(5),t.Y8G("ngIf","trip"===n.currentView),t.R7$(),t.Y8G("ngIf","consumption"===n.currentView)}}const K=[{path:"",component:(()=>{var a;class c{constructor(i,e,l,d,s,_){this.vehicleService=i,this.alertCtrl=e,this.toastCtrl=l,this.route=d,this.ads=s,this.ajuda_odometro=_,this.currentView="menu",this.vehicles=[],this.selectedVehicle=null,this.distance=null,this.fuelPrice=null,this.fuelPriceStr="",this.costObservations="",this.result=null,this.litersNeeded=null,this.calcSelectedVehicle="",this.calcDate="",this.calcInitialOdometer=null,this.calcFinalOdometer=null,this.calcDist=null,this.calcLiters=null,this.calcResult=null,this.isHistoryOpen=!1,this.isEditing=!1,this.editingId=void 0,this.tripDate=(new Date).toISOString(),this.placa_padrao_atual=null,this.placa_parametro=null,this.calcDisplay="0",this.currentInput="",this.previousInput="",this.operation=null,this.shouldResetDisplay=!1,(0,V.a)({backspaceOutline:m.GvW,create:m.vtF,speedometerOutline:m.MrY,carOutline:m.hsd,calculatorOutline:m.N0h,arrowBackOutline:m.hGB,mapOutline:m.dG8})}ngOnInit(){this.initDate(),this.ads.preloadInterstitial(),this.route.queryParams.subscribe(i=>{i&&i.plate&&(this.placa_parametro=i.plate)}),this.vehicleService.getVehicles().subscribe(i=>{let e;this.vehicles=i,this.placa_parametro&&(e=this.vehicles.find(s=>s.plate===this.placa_parametro));const l=this.vehicles.find(s=>s.isDefault)||null,d=l?l.plate:null;if(e&&!this.selectedVehicle&&(this.selectedVehicle=e,this.calcSelectedVehicle||(this.calcSelectedVehicle=e.plate)),d&&d!==this.placa_padrao_atual&&(this.placa_padrao_atual=d,this.placa_parametro||(this.selectedVehicle=l,this.calcSelectedVehicle=d)),!this.selectedVehicle&&this.vehicles.length>0){const s=this.vehicles[0];this.selectedVehicle=s,this.calcSelectedVehicle||(this.calcSelectedVehicle=s.plate)}else!this.calcSelectedVehicle&&this.selectedVehicle&&(this.calcSelectedVehicle=this.selectedVehicle.plate)})}initDate(){const i=new Date,e=6e4*i.getTimezoneOffset(),l=new Date(i.getTime()-e).toISOString();this.calcDate=l,this.tripDate=l}setView(i){this.currentView=i}updateDistance(){null!==this.calcInitialOdometer&&null!==this.calcFinalOdometer&&(this.calcDist=this.calcFinalOdometer-this.calcInitialOdometer),this.calculateConsumption()}calculateConsumption(){this.calcResult=this.calcDist&&this.calcLiters&&this.calcLiters>0?this.calcDist/this.calcLiters:null}saveConsumption(){var i=this;return(0,b.A)(function*(){var j;if(i.calcSelectedVehicle&&i.calcResult&&i.calcDist&&i.calcLiters){if(i.vehicleService.addConsumptionRecord(i.calcSelectedVehicle,{date:new Date,initialOdometer:i.calcInitialOdometer??void 0,finalOdometer:i.calcFinalOdometer??void 0,distance:i.calcDist,liters:i.calcLiters,result:i.calcResult})){yield(yield i.toastCtrl.create({message:"C\xe1lculo salvo com sucesso!",duration:2e3,position:"bottom",color:"success"})).present();const s=yield i.ads.showInterstitialWithResult();if(!s.ok||!s.shown){if("throttled"===s.reason)return;const _=i.ads.obterDiagnostico(),f=`reason=${s.reason||"unknown"}; error=${s.error||""}; adId=${_.adId}; testMode=${_.testMode}; plataforma=${_.plataforma}${_.ultimoErro?"; ultimoErro="+_.ultimoErro:""}${_.diagnosticoAtivo?"; diagnosticoAtivo=true":""}`;yield(yield i.alertCtrl.create({header:"Falha ao exibir an\xfancio",message:"N\xe3o foi poss\xedvel exibir o an\xfancio agora.",buttons:[{text:"Copiar",handler:(j=(0,b.A)(function*(){try{yield navigator.clipboard?.writeText(f)}catch{try{window.prompt?.("Copiar detalhes do erro:",f)}catch{}}}),function(){return j.apply(this,arguments)})},{text:"OK",role:"cancel"}]})).present()}i.calcInitialOdometer=null,i.calcFinalOdometer=null,i.calcDist=null,i.calcLiters=null,i.calcResult=null}}else yield(yield i.alertCtrl.create({header:"Campos Obrigat\xf3rios",message:"Por favor, selecione um ve\xedculo e certifique-se que o c\xe1lculo foi realizado.",buttons:["OK"]})).present()})()}onVehicleChange(){this.isEditing||(this.result=null,this.litersNeeded=null)}calculate(){this.fuelPrice=this.parseCurrency(this.fuelPriceStr),this.selectedVehicle&&this.distance&&this.fuelPrice&&this.selectedVehicle.consumption?(this.litersNeeded=this.distance/this.selectedVehicle.consumption,this.result=this.litersNeeded*this.fuelPrice):alert("Por favor, preencha todos os campos e certifique-se que o ve\xedculo tem consumo cadastrado.")}saveTrip(){var i=this;return(0,b.A)(function*(){if(i.fuelPrice=i.parseCurrency(i.fuelPriceStr),!(i.selectedVehicle&&i.result&&i.distance&&i.fuelPrice))return void(yield(yield i.alertCtrl.create({header:"Aten\xe7\xe3o",message:"Calcule o custo antes de salvar.",buttons:["OK"]})).present());const e=i.tripDate.split("T")[0],[l,d,s]=e.split("-").map(Number),_=new Date(l,d-1,s),f={id:i.isEditing?i.editingId:void 0,date:_,distance:i.distance,consumption:i.selectedVehicle.consumption||0,fuelPrice:i.fuelPrice,totalCost:i.result,createdAt:Date.now()};let C=!1;if(C=i.isEditing?i.vehicleService.updateTrip(i.selectedVehicle.plate,f):i.vehicleService.addTrip(i.selectedVehicle.plate,f),C){yield(yield i.toastCtrl.create({message:i.isEditing?"Viagem atualizada com sucesso!":"Viagem salva no hist\xf3rico!",duration:2e3,position:"bottom",color:"success"})).present();const g=yield i.ads.showInterstitialWithResult();if(!g.ok||!g.shown){if("throttled"===g.reason)return;const h=i.ads.obterDiagnostico(),F=`reason=${g.reason||"unknown"}; error=${g.error||""}; adId=${h.adId}; testMode=${h.testMode}; plataforma=${h.plataforma}${h.ultimoErro?"; ultimoErro="+h.ultimoErro:""}${h.diagnosticoAtivo?"; diagnosticoAtivo=true":""}`;yield(yield i.alertCtrl.create({header:"Falha ao exibir an\xfancio",message:"N\xe3o foi poss\xedvel exibir o an\xfancio agora.",buttons:[{text:"Copiar",handler:(Q=(0,b.A)(function*(){try{yield navigator.clipboard?.writeText(F)}catch{try{window.prompt?.("Copiar detalhes do erro:",F)}catch{}}}),function(){return Q.apply(this,arguments)})},{text:"OK",role:"cancel"}]})).present()}i.clearForm(),i.setHistoryOpen(!1)}var Q})()}clearForm(){this.distance=null,this.fuelPrice=null,this.fuelPriceStr="",this.costObservations="",this.result=null,this.litersNeeded=null,this.isEditing=!1,this.editingId=void 0}get tripHistory(){const i=[];return this.vehicles.forEach(e=>{e.trips&&e.trips.forEach(l=>{i.push({vehicle:e,trip:l})})}),i.sort((e,l)=>new Date(l.trip.date).getTime()-new Date(e.trip.date).getTime())}get consumptionHistory(){const i=[];return this.vehicles.forEach(e=>{e.consumptionHistory&&e.consumptionHistory.forEach(l=>{i.push({vehicle:e,record:l})})}),i.sort((e,l)=>new Date(l.record.date).getTime()-new Date(e.record.date).getTime())}setHistoryOpen(i){this.isHistoryOpen=i,i||(this.isEditing=!1,this.editingId=void 0)}editHistoryItem(i){this.isHistoryOpen=!1,this.isEditing=!0,this.editingId=i.trip.id,this.selectedVehicle=this.vehicles.find(d=>d.plate===i.vehicle.plate)||null;const e=new Date(i.trip.date),l=6e4*e.getTimezoneOffset();this.tripDate=new Date(e.getTime()-l).toISOString(),this.distance=i.trip.distance,this.fuelPrice=i.trip.fuelPrice,this.fuelPriceStr=this.fuelPrice?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(this.fuelPrice):"",this.result=i.trip.totalCost,this.selectedVehicle&&this.selectedVehicle.consumption&&(this.litersNeeded=this.distance/this.selectedVehicle.consumption)}formatCurrency(i){let e=i.target.value;if(e=e.replace(/\D/g,""),""===e)return void(this.fuelPriceStr="");const l=parseInt(e,10)/100;this.fuelPriceStr=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l)}parseCurrency(i){if(!i)return null;const e=i.replace(/[^\d,]/g,"").replace(",",".");return parseFloat(e)}appendNumber(i){this.shouldResetDisplay&&(this.calcDisplay="",this.shouldResetDisplay=!1),"0"===this.calcDisplay&&"."!==i?this.calcDisplay=i:this.calcDisplay+=i}backspace(){this.calcDisplay=this.calcDisplay.length>1?this.calcDisplay.slice(0,-1):"0"}percentage(){const i=parseFloat(this.calcDisplay);this.calcDisplay=(i/100).toString(),this.shouldResetDisplay=!0}setOperation(i){null!==this.operation&&this.calculateResult(),this.previousInput=this.calcDisplay,this.operation=i,this.shouldResetDisplay=!0}calculateResult(){if(null===this.operation||this.shouldResetDisplay)return;const i=parseFloat(this.previousInput),e=parseFloat(this.calcDisplay);let l=0;switch(this.operation){case"+":l=i+e;break;case"-":l=i-e;break;case"*":l=i*e;break;case"/":l=i/e}this.calcDisplay=l.toString(),this.operation=null,this.shouldResetDisplay=!0}clearCalculator(){this.calcDisplay="0",this.currentInput="",this.previousInput="",this.operation=null,this.shouldResetDisplay=!1}static#t=a=()=>(this.\u0275fac=function(e){return new(e||c)(t.rXU(I.K),t.rXU(r.hG),t.rXU(r.K_),t.rXU(P.nX),t.rXU(y.g),t.rXU(E.k))},this.\u0275cmp=t.VBU({type:c,selectors:[["app-calculator"]],standalone:!1,decls:16,vars:10,consts:[[3,"translucent"],["slot","start",4,"ngIf"],[1,"ion-padding",3,"fullscreen"],["collapse","condense"],["size","large"],["class","menu-container",4,"ngIf"],[4,"ngIf"],[3,"didDismiss","isOpen"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"menu-container"],[1,"menu-button",3,"click"],["name","speedometer-outline"],["name","map-outline"],["name","calculator-outline"],[1,"ion-padding-bottom"],["label","Selecione o Ve\xedculo","label-placement","floating","placeholder","Escolha um ve\xedculo",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["position","stacked"],["datetime","trip-datetime"],[3,"keepContentsMounted"],["label","Dist\xe2ncia (km)","type","number","inputmode","numeric","label-placement","floating","placeholder","Ex: 150",3,"ngModelChange","ngModel"],["label","Pre\xe7o do Combust\xedvel (R$)","type","tel","inputmode","decimal","label-placement","floating","placeholder","R$ 0,00",3,"ngModelChange","ionInput","ngModel"],["label","Observa\xe7\xf5es","label-placement","floating","placeholder","Opcional","rows","3",3,"ngModelChange","ngModel"],["expand","block",1,"ion-margin-top",3,"click"],["expand","block","fill","outline",1,"ion-margin-top",3,"click"],["class","ion-margin-top",4,"ngIf"],[3,"value"],["id","trip-datetime","presentation","date","locale","pt-BR",3,"ngModelChange","ngModel"],[1,"ion-margin-top"],["expand","block","color","success",1,"ion-margin-top",3,"click"],["label","Ve\xedculo","label-placement","stacked",3,"ngModelChange","ngModel"],["datetime","calc-consumption-datetime"],["tabindex","0",1,"icone-ajuda-odometro",3,"click"],["type","number","inputmode","numeric",3,"ngModelChange","ionChange","ngModel"],["type","number","inputmode","numeric","label","Dist\xe2ncia Percorrida (km)","label-placement","stacked","readonly","",3,"ngModelChange","ngModel"],["type","number","inputmode","decimal","label","Litros Abastecidos","label-placement","stacked",3,"ngModelChange","ionChange","ngModel"],["lines","none"],[2,"font-size","24px","font-weight","bold","color","var(--ion-color-primary)"],["id","calc-consumption-datetime","presentation","date","locale","pt-BR",3,"ngModelChange","ngModel"],[1,"calculator-container","ion-margin-top"],[1,"calc-display"],[1,"calc-grid"],["color","primary","fill","outline",3,"click"],["name","backspace-outline"],["color","primary",3,"click"],["color","light",3,"click"],["color","light",1,"double-col",3,"click"],["slot","end"],[4,"ngFor","ngForOf"],["class","ion-padding ion-text-center",4,"ngIf"],["slot","end","color","success",2,"font-size","1.1em","font-weight","bold"],["slot","end","fill","clear",3,"click"],["name","create","slot","icon-only"],[1,"ion-padding","ion-text-center"],["slot","end","color","primary",2,"font-size","1.1em","font-weight","bold"]],template:function(e,l){1&e&&(t.j41(0,"ion-header",0)(1,"ion-toolbar"),t.DNE(2,D,3,0,"ion-buttons",1),t.j41(3,"ion-title"),t.EFF(4),t.k0s()()(),t.j41(5,"ion-content",2)(6,"ion-header",3)(7,"ion-toolbar")(8,"ion-title",4),t.EFF(9),t.k0s()()(),t.DNE(10,R,13,0,"div",5)(11,T,26,8,"div",6)(12,B,41,11,"div",6)(13,S,43,1,"div",6),t.j41(14,"ion-modal",7),t.bIt("didDismiss",function(){return l.setHistoryOpen(!1)}),t.DNE(15,U,10,3,"ng-template"),t.k0s()()),2&e&&(t.Y8G("translucent",!0),t.R7$(2),t.Y8G("ngIf","menu"!==l.currentView),t.R7$(2),t.SpI(" ","menu"===l.currentView?"Calcular":"trip"===l.currentView?"Calcular Viagem":"consumption"===l.currentView?"Calcular Consumo":"Calculadora"," "),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(4),t.SpI(" ","menu"===l.currentView?"Calcular":"trip"===l.currentView?"Calcular Viagem":"consumption"===l.currentView?"Calcular Consumo":"Calculadora"," "),t.R7$(),t.Y8G("ngIf","menu"===l.currentView),t.R7$(),t.Y8G("ngIf","trip"===l.currentView),t.R7$(),t.Y8G("ngIf","consumption"===l.currentView),t.R7$(),t.Y8G("ngIf","simple"===l.currentView),t.R7$(),t.Y8G("isOpen",l.isHistoryOpen))},dependencies:[p.Sq,p.bT,k.BC,k.vS,r.Jm,r.QW,r.b_,r.I9,r.ME,r.tN,r.W9,r.A9,r.K4,r.eU,r.iq,r.$w,r.uz,r.he,r.nf,r.JI,r.Nm,r.Ip,r.nc,r.BC,r.ai,r.Sb,r.su,r.Je,r.Gw,p.Pc,p.QX,p.oe,p.vh],styles:[".calculator-container[_ngcontent-%COMP%]{background:var(--ion-color-step-50, #f4f5f8);background:var(--ion-card-background, #fff);background:linear-gradient(145deg,var(--ion-color-step-100, #e6e6e6),var(--ion-color-step-50, #ffffff));padding:15px;border-radius:20px;box-shadow:0 5px 15px #0000001a,inset 0 1px 1px #fff6;max-width:280px;margin:20px auto;border:1px solid var(--ion-color-step-150, rgba(0, 0, 0, .05))}@media (prefers-color-scheme: dark){.calculator-container[_ngcontent-%COMP%]{background:linear-gradient(145deg,#2b2d31,#1e2023);box-shadow:0 10px 20px #0006,inset 0 1px 1px #ffffff1a;border:1px solid rgba(255,255,255,.05)}}body.dark[_nghost-%COMP%]   .calculator-container[_ngcontent-%COMP%], body.dark   [_nghost-%COMP%]   .calculator-container[_ngcontent-%COMP%]{background:linear-gradient(145deg,#2b2d31,#1e2023);box-shadow:0 10px 20px #0006,inset 0 1px 1px #ffffff1a;border:1px solid rgba(255,255,255,.05)}.calc-display[_ngcontent-%COMP%]{background:var(--ion-color-step-100, rgba(0, 0, 0, .05));color:var(--ion-text-color, #000);font-size:2.5rem;font-weight:300;text-align:right;padding:15px 20px;border-radius:12px;margin-bottom:20px;overflow-x:auto;white-space:nowrap;box-shadow:inset 0 2px 5px #0000000d;border:1px solid var(--ion-color-step-200, rgba(0, 0, 0, .05))}.calc-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}.calc-grid[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;height:50px;margin:0;font-size:1.2rem;font-weight:500;--box-shadow: 0 4px 6px rgba(0,0,0,.1);transition:transform .1s}.calc-grid[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.calc-grid[_ngcontent-%COMP%]   ion-button[color=light][_ngcontent-%COMP%]{--background: var(--ion-color-step-50, #fff);--color: var(--ion-text-color, #333);--background-activated: var(--ion-color-step-150, #f0f0f0)}.calc-grid[_ngcontent-%COMP%]   ion-button[color=primary][_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast);font-weight:600}.calc-grid[_ngcontent-%COMP%]   ion-button[color=primary][_ngcontent-%COMP%]:last-child{--background: var(--ion-color-success)}.calc-grid[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]{--border-color: var(--ion-color-medium);--color: var(--ion-color-medium);--border-width: 1px}.double-col[_ngcontent-%COMP%]{grid-column:span 2}.menu-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px;justify-content:center;align-items:stretch;min-height:60vh}.menu-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--ion-card-background, #fff);border-radius:20px;padding:14px 18px;box-shadow:0 8px 20px #0000001f;cursor:pointer;transition:transform .2s cubic-bezier(.25,.8,.25,1);width:100%;height:auto}.menu-button[_ngcontent-%COMP%]:active{transform:scale(.95);background:var(--ion-color-step-50, #f9f9f9);box-shadow:0 4px 10px #0000001a}.menu-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:15px;margin-right:0;color:var(--ion-color-primary)}.menu-button[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;text-align:center;color:var(--ion-text-color);line-height:1.3}"]}))}return a(),c})()}];let J=(()=>{var a;class c{static#t=a=()=>(this.\u0275fac=function(e){return new(e||c)},this.\u0275mod=t.$C({type:c}),this.\u0275inj=o.G2t({imports:[v.iI.forChild(K),v.iI]}))}return a(),c})(),W=(()=>{var a;class c{static#t=a=()=>(this.\u0275fac=function(e){return new(e||c)},this.\u0275mod=t.$C({type:c}),this.\u0275inj=o.G2t({imports:[p.MD,k.YN,r.bv,J]}))}return a(),c})()}}]);