"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2182],{2182(b,I,d){d.d(I,{MaintenanceHistoryPageModule:()=>O});var E=d(2200),S=d(4341),t=d(7343),u=d(8132),V=d(467),D=d(3085),e=d(3664),n=d(2615),a=d(9198),i=d(5355),o=d(6991);function h(r,v){1&r&&(e.j41(0,"div",4)(1,"p"),e.EFF(2,"Nenhuma manuten\xe7\xe3o registrada."),e.k0s()())}function C(r,v){if(1&r){const m=e.RV6();e.j41(0,"p")(1,"strong"),e.EFF(2,"Od\xf4metro:"),e.k0s(),e.j41(3,"span",13),e.bIt("click",function(p){n.eBV(m);const g=e.XpG(3);return n.Njj(g.ajuda_odometro.mostrarAjudaOdometro(p))}),e.EFF(4,"?"),e.k0s(),e.EFF(5),e.k0s()}if(2&r){const m=e.XpG().$implicit;e.R7$(5),e.SpI(" ",m.odometer," km ")}}function P(r,v){if(1&r&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Pe\xe7as:"),e.k0s(),e.EFF(3),e.k0s()),2&r){const m=e.XpG().$implicit;e.R7$(3),e.SpI(" ",m.parts)}}function l(r,v){if(1&r&&(e.j41(0,"p"),e.EFF(1),e.nI1(2,"number"),e.k0s()),2&r){const m=e.XpG(2).$implicit;e.R7$(),e.SpI("Pe\xe7as: R$ ",e.i5U(2,1,m.partsValue,"1.2-2"))}}function s(r,v){if(1&r&&(e.j41(0,"p"),e.EFF(1),e.nI1(2,"number"),e.k0s()),2&r){const m=e.XpG(2).$implicit;e.R7$(),e.SpI("M\xe3o de obra: R$ ",e.i5U(2,1,m.serviceValue,"1.2-2"))}}function _(r,v){if(1&r&&(e.j41(0,"div",14),e.DNE(1,l,3,4,"p",3)(2,s,3,4,"p",3),e.j41(3,"p")(4,"strong"),e.EFF(5),e.nI1(6,"number"),e.k0s()()()),2&r){const m=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",m.partsValue),e.R7$(),e.Y8G("ngIf",m.serviceValue),e.R7$(3),e.SpI("Total: R$ ",e.i5U(6,3,m.totalValue,"1.2-2"))}}function c(r,v){if(1&r){const m=e.RV6();e.j41(0,"ion-item")(1,"ion-label",6)(2,"h2"),e.EFF(3),e.j41(4,"small"),e.EFF(5),e.k0s()(),e.j41(6,"p")(7,"strong"),e.EFF(8,"Data:"),e.k0s(),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Servi\xe7o:"),e.k0s(),e.EFF(14),e.k0s(),e.DNE(15,C,6,1,"p",3)(16,P,4,1,"p",3)(17,_,7,6,"div",7),e.k0s(),e.j41(18,"ion-buttons",8)(19,"ion-button",9),e.bIt("click",function(){const p=n.eBV(m).$implicit,g=e.XpG(2);return n.Njj(g.editar_manutencao(p))}),e.nrm(20,"ion-icon",10),e.k0s(),e.j41(21,"ion-button",11),e.bIt("click",function(){const p=n.eBV(m).$implicit,g=e.XpG(2);return n.Njj(g.remover_manutencao(p))}),e.nrm(22,"ion-icon",12),e.k0s()()()}if(2&r){const m=v.$implicit;e.R7$(3),e.SpI("",m.vehicleModel," "),e.R7$(2),e.SpI("(",m.vehiclePlate,")"),e.R7$(4),e.SpI(" ",e.i5U(10,7,m.date,"dd/MM/yyyy")),e.R7$(5),e.SpI(" ",m.summary),e.R7$(),e.Y8G("ngIf",m.odometer),e.R7$(),e.Y8G("ngIf",m.parts),e.R7$(),e.Y8G("ngIf",m.totalValue)}}function j(r,v){if(1&r&&(e.j41(0,"ion-list"),e.DNE(1,c,23,10,"ion-item",5),e.k0s()),2&r){const m=e.XpG();e.R7$(),e.Y8G("ngForOf",m.maintenances)}}const R=[{path:"",component:(()=>{var r;class v{constructor(f,p,g,M,y){this.vehicleService=f,this.ajuda_odometro=p,this.route=g,this.alertCtrl=M,this.modalCtrl=y,this.maintenances=[],this.vehicles=[],this.placaFiltrada=null}ngOnInit(){this.placaFiltrada=this.route.snapshot.queryParamMap.get("plate"),this.vehicleService.getVehicles().subscribe(f=>{this.vehicles=f,this.maintenances=this.flattenMaintenances(f,this.placaFiltrada)})}flattenMaintenances(f,p){const g=[];return f.forEach(M=>{p&&M.plate!==p||M.maintenance&&M.maintenance.forEach(y=>{g.push({...y,vehicleModel:M.model,vehiclePlate:M.plate})})}),g.sort((M,y)=>new Date(y.date).getTime()-new Date(M.date).getTime())}editar_manutencao(f){var p=this;return(0,V.A)(function*(){const g=p.vehicles.find(k=>k.plate===f.vehiclePlate);if(!g)return;const M=yield p.modalCtrl.create({component:D.O,componentProps:{vehicles:p.vehicles,editingMaintenance:f,editingVehiclePlate:g.plate}});yield M.present();const{data:y}=yield M.onWillDismiss();y&&y.saved&&(p.maintenances=p.flattenMaintenances(p.vehicles,p.placaFiltrada))})()}remover_manutencao(f){var p=this;return(0,V.A)(function*(){if(!f.id)return;const g=p.vehicles.find(y=>y.plate===f.vehiclePlate);g&&(yield(yield p.alertCtrl.create({header:"Confirmar exclus\xe3o",message:"Deseja realmente excluir esta manuten\xe7\xe3o?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",role:"destructive",handler:()=>{p.vehicleService.removerManutencao(g.plate,f.id),p.maintenances=p.flattenMaintenances(p.vehicles,p.placaFiltrada)}}]})).present())})()}}return(r=v).\u0275fac=function(f){return new(f||r)(e.rXU(a.K),e.rXU(i.k),e.rXU(o.nX),e.rXU(t.hG),e.rXU(t.W3))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-maintenance-history"]],standalone:!1,decls:9,vars:2,consts:[["slot","start"],["defaultHref","/tabs/home","text","Voltar"],["class","ion-padding ion-text-center",4,"ngIf"],[4,"ngIf"],[1,"ion-padding","ion-text-center"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["class","values-container ion-margin-top",4,"ngIf"],["slot","end"],["fill","clear",3,"click"],["slot","icon-only","name","create-outline"],["fill","clear","color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["tabindex","0",1,"icone-ajuda-odometro",3,"click"],[1,"values-container","ion-margin-top"]],template:function(f,p){1&f&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Hist\xf3rico de Manuten\xe7\xf5es"),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,h,3,0,"div",2)(8,j,2,1,"ion-list",3),e.k0s()),2&f&&(e.R7$(7),e.Y8G("ngIf",0===p.maintenances.length),e.R7$(),e.Y8G("ngIf",p.maintenances.length>0))},dependencies:[E.Sq,E.bT,t.Jm,t.QW,t.W9,t.eU,t.iq,t.uz,t.he,t.nf,t.BC,t.ai,t.el,E.QX,E.vh],encapsulation:2}),v})()}];let T=(()=>{var r;class v{}return(r=v).\u0275fac=function(f){return new(f||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=n.G2t({imports:[u.iI.forChild(R),u.iI]}),v})(),O=(()=>{var r;class v{}return(r=v).\u0275fac=function(f){return new(f||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=n.G2t({imports:[E.MD,S.YN,t.bv,T]}),v})()},3085(b,I,d){d.d(I,{O:()=>o});var E=d(467),S=d(2615),t=d(3664),u=d(7343),V=d(9198),D=d(6991),e=d(2200),n=d(4341);function a(h,C){if(1&h&&(t.j41(0,"ion-select-option",16),t.EFF(1),t.nI1(2,"uppercase"),t.k0s()),2&h){const P=C.$implicit;t.Y8G("value",P.plate),t.R7$(),t.Lme("",P.model," (",t.bMT(2,3,P.plate),")")}}function i(h,C){if(1&h){const P=t.RV6();t.j41(0,"ion-datetime",17),t.mxI("ngModelChange",function(s){S.eBV(P);const _=t.XpG();return t.DH7(_.maintDate,s)||(_.maintDate=s),S.Njj(s)}),t.k0s()}if(2&h){const P=t.XpG();t.R50("ngModel",P.maintDate)}}let o=(()=>{var h;class C{constructor(l,s,_,c,j){this.modalCtrl=l,this.vehicleService=s,this.alertCtrl=_,this.toastCtrl=c,this.router=j,this.vehicles=[],this.editingMaintenance=null,this.editingVehiclePlate=null,this.maintDate="",this.maintVehicle="",this.maintOdometer=null,this.maintSummary="",this.maintParts="",this.maintPartsValue=null,this.maintPartsValueStr="",this.maintServiceValue=null,this.maintServiceValueStr="",this.maintTotalValue=null,this.maintTotalValueStr="",this.isEditing=!1}ngOnInit(){if(this.initDate(),this.editingMaintenance&&this.editingVehiclePlate)this.isEditing=!0,this.loadMaintenance(this.editingMaintenance);else if(this.editingVehiclePlate)this.maintVehicle=this.editingVehiclePlate;else if(this.vehicles.length>0){const l=this.vehicles.find(s=>s.isDefault);this.maintVehicle=l?l.plate:this.vehicles[0].plate}}set preSelectedPlate(l){l&&(this.maintVehicle=l)}initDate(){const l=new Date,s=6e4*l.getTimezoneOffset();this.maintDate=new Date(l.getTime()-s).toISOString()}loadMaintenance(l){this.maintVehicle=this.editingVehiclePlate;const s=new Date(l.date),_=6e4*s.getTimezoneOffset();this.maintDate=new Date(s.getTime()-_).toISOString(),this.maintOdometer=l.odometer,this.maintSummary=l.summary,this.maintParts=l.parts||"",this.maintPartsValue=l.partsValue||null,this.maintPartsValueStr=this.maintPartsValue?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(this.maintPartsValue):"",this.maintServiceValue=l.serviceValue||null,this.maintServiceValueStr=this.maintServiceValue?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(this.maintServiceValue):"",this.maintTotalValue=l.totalValue,this.maintTotalValueStr=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(this.maintTotalValue)}close(){this.modalCtrl.dismiss()}handleCurrencyInput(l,s){let _=l.target.value;if(_=_.replace(/\D/g,""),""===_)return this[s]="","maintPartsValueStr"===s&&(this.maintPartsValue=null),"maintServiceValueStr"===s&&(this.maintServiceValue=null),void this.updateMaintenanceTotal();const c=parseInt(_,10)/100;this[s]=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),"maintPartsValueStr"===s&&(this.maintPartsValue=c),"maintServiceValueStr"===s&&(this.maintServiceValue=c),this.updateMaintenanceTotal()}updateMaintenanceTotal(){this.maintTotalValue=(this.maintPartsValue||0)+(this.maintServiceValue||0),this.maintTotalValueStr=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(this.maintTotalValue)}save(){var l=this;return(0,E.A)(function*(){if(!(l.maintVehicle&&l.maintDate&&l.maintOdometer&&l.maintSummary&&l.maintTotalValue))return void(yield(yield l.alertCtrl.create({header:"Aten\xe7\xe3o",message:"Preencha os campos obrigat\xf3rios (Ve\xedculo, Data, Od\xf4metro, Resumo e Valores).",buttons:["OK"]})).present());const s=l.maintDate.split("T")[0],[_,c,j]=s.split("-").map(Number),F=new Date(_,c-1,j),R={id:l.isEditing?l.editingMaintenance.id:void 0,date:F,odometer:l.maintOdometer,summary:l.maintSummary,parts:l.maintParts,partsValue:l.maintPartsValue||0,serviceValue:l.maintServiceValue||0,totalValue:l.maintTotalValue};l.isEditing?l.vehicleService.updateMaintenance(l.maintVehicle,R):l.vehicleService.addMaintenance(l.maintVehicle,R),yield(yield l.toastCtrl.create({message:l.isEditing?"Manuten\xe7\xe3o atualizada com sucesso!":"Manuten\xe7\xe3o registrada com sucesso!",duration:2e3,position:"bottom",color:"success"})).present(),l.modalCtrl.dismiss({saved:!0})})()}viewHistory(){this.modalCtrl.dismiss({action:"view_history"})}}return(h=C).\u0275fac=function(l){return new(l||h)(t.rXU(u.W3),t.rXU(V.K),t.rXU(u.hG),t.rXU(u.K_),t.rXU(D.Ix))},h.\u0275cmp=t.VBU({type:h,selectors:[["app-maintenance-modal"]],inputs:{vehicles:"vehicles",editingMaintenance:"editingMaintenance",editingVehiclePlate:"editingVehiclePlate",preSelectedPlate:"preSelectedPlate"},standalone:!1,decls:33,vars:11,consts:[["slot","end"],[3,"click"],[1,"ion-padding"],["label","Ve\xedculo","label-placement","stacked",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["position","stacked"],["datetime","maint-datetime"],[3,"keepContentsMounted"],["type","number","inputmode","numeric","label","Od\xf4metro (km)","label-placement","stacked",3,"ngModelChange","ngModel"],["label","Resumo do Servi\xe7o","label-placement","stacked","placeholder","Ex: Troca de \xf3leo",3,"ngModelChange","ngModel"],["label","Pe\xe7as / Detalhes","label-placement","stacked","placeholder","Ex: Filtro de \xf3leo, 4L \xf3leo 5w30...",3,"ngModelChange","ngModel"],["type","tel","inputmode","decimal","label","Valor Pe\xe7as (R$)","label-placement","stacked","placeholder","R$ 0,00",3,"ngModelChange","ionInput","ngModel"],["type","tel","inputmode","decimal","label","Valor M\xe3o de Obra (R$)","label-placement","stacked","placeholder","R$ 0,00",3,"ngModelChange","ionInput","ngModel"],["label","Valor Total (R$)","label-placement","stacked","readonly","",3,"ngModelChange","ngModel"],["expand","block",1,"ion-margin-top",3,"click"],["expand","block","fill","outline",1,"ion-margin-top",3,"click"],[3,"value"],["id","maint-datetime","presentation","date","locale","pt-BR",3,"ngModelChange","ngModel"]],template:function(l,s){1&l&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",0)(5,"ion-button",1),t.bIt("click",function(){return s.close()}),t.EFF(6,"Fechar"),t.k0s()()()(),t.j41(7,"ion-content",2)(8,"ion-item")(9,"ion-select",3),t.mxI("ngModelChange",function(c){return t.DH7(s.maintVehicle,c)||(s.maintVehicle=c),c}),t.DNE(10,a,3,5,"ion-select-option",4),t.k0s()(),t.j41(11,"ion-item")(12,"ion-label",5),t.EFF(13,"Data"),t.k0s(),t.nrm(14,"ion-datetime-button",6),t.j41(15,"ion-modal",7),t.DNE(16,i,1,1,"ng-template"),t.k0s()(),t.j41(17,"ion-item")(18,"ion-input",8),t.mxI("ngModelChange",function(c){return t.DH7(s.maintOdometer,c)||(s.maintOdometer=c),c}),t.k0s()(),t.j41(19,"ion-item")(20,"ion-input",9),t.mxI("ngModelChange",function(c){return t.DH7(s.maintSummary,c)||(s.maintSummary=c),c}),t.k0s()(),t.j41(21,"ion-item")(22,"ion-textarea",10),t.mxI("ngModelChange",function(c){return t.DH7(s.maintParts,c)||(s.maintParts=c),c}),t.k0s()(),t.j41(23,"ion-item")(24,"ion-input",11),t.mxI("ngModelChange",function(c){return t.DH7(s.maintPartsValueStr,c)||(s.maintPartsValueStr=c),c}),t.bIt("ionInput",function(c){return s.handleCurrencyInput(c,"maintPartsValueStr")}),t.k0s()(),t.j41(25,"ion-item")(26,"ion-input",12),t.mxI("ngModelChange",function(c){return t.DH7(s.maintServiceValueStr,c)||(s.maintServiceValueStr=c),c}),t.bIt("ionInput",function(c){return s.handleCurrencyInput(c,"maintServiceValueStr")}),t.k0s()(),t.j41(27,"ion-item")(28,"ion-input",13),t.mxI("ngModelChange",function(c){return t.DH7(s.maintTotalValueStr,c)||(s.maintTotalValueStr=c),c}),t.k0s()(),t.j41(29,"ion-button",14),t.bIt("click",function(){return s.save()}),t.EFF(30),t.k0s(),t.j41(31,"ion-button",15),t.bIt("click",function(){return s.viewHistory()}),t.EFF(32," Hist\xf3rico "),t.k0s()()),2&l&&(t.R7$(3),t.JRh(s.isEditing?"Editar Manuten\xe7\xe3o":"Nova Manuten\xe7\xe3o"),t.R7$(6),t.R50("ngModel",s.maintVehicle),t.R7$(),t.Y8G("ngForOf",s.vehicles),t.R7$(5),t.Y8G("keepContentsMounted",!0),t.R7$(3),t.R50("ngModel",s.maintOdometer),t.R7$(2),t.R50("ngModel",s.maintSummary),t.R7$(2),t.R50("ngModel",s.maintParts),t.R7$(2),t.R50("ngModel",s.maintPartsValueStr),t.R7$(2),t.R50("ngModel",s.maintServiceValueStr),t.R7$(2),t.R50("ngModel",s.maintTotalValueStr),t.R7$(2),t.SpI(" ",s.isEditing?"Atualizar":"Salvar"," "))},dependencies:[e.Sq,n.BC,n.vS,u.Jm,u.QW,u.W9,u.A9,u.K4,u.eU,u.$w,u.uz,u.he,u.Nm,u.Ip,u.nc,u.BC,u.ai,u.Sb,u.su,u.Je,u.Gw,e.Pc],encapsulation:2}),C})()},5355(b,I,d){d.d(I,{k:()=>e});var E=d(467),S=d(7343),t=d(2200),u=d(2615),V=d(3664);let D=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=V.VBU({type:n,selectors:[["app-ajuda-odometro-popover"]],decls:2,vars:0,consts:[[1,"conteudo-ajuda-odometro"]],template:function(o,h){1&o&&(V.rj2(0,"div",0),V.EFF(1," Od\xf4metro \xe9 o indicador que registra a quilometragem total do ve\xedculo desde zero. Voc\xea pode ver esse n\xfamero no painel, pr\xf3ximo ao veloc\xedmetro. "),V.eux())},dependencies:[t.MD,S.bv],encapsulation:2}),a})(),e=(()=>{var n;class a{constructor(o){this.controlador_popover=o}mostrarAjudaOdometro(o){var h=this;return(0,E.A)(function*(){yield(yield h.controlador_popover.create({component:D,event:o,side:"right",alignment:"center",showBackdrop:!1,cssClass:"popover-ajuda-odometro"})).present()})()}}return(n=a).\u0275fac=function(o){return new(o||n)(u.KVO(S.IE))},n.\u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),a})()},9198(b,I,d){d.d(I,{K:()=>t});var E=d(4412),S=d(2615);let t=(()=>{var u;class V{constructor(){this.vehicles=[],this.vehiclesSubject=new E.t([]),this.STORAGE_KEY="kmrodados_vehicles",this.loadVehicles()}loadVehicles(){const e=localStorage.getItem(this.STORAGE_KEY);e&&this.processLoadedVehicles(JSON.parse(e))}processLoadedVehicles(e){this.vehicles=e.map(n=>({...n,plate:n.plate?n.plate.toUpperCase():n.plate})),this.vehicles.forEach(n=>{n.supplies&&n.supplies.forEach(a=>{a.date=new Date(a.date),a.id||(a.id=this.generateId())}),n.consumptionHistory&&n.consumptionHistory.forEach(a=>{a.date=new Date(a.date),a.id||(a.id=this.generateId())}),n.maintenance&&n.maintenance.forEach(a=>{a.date=new Date(a.date),a.id||(a.id=this.generateId())})}),this.vehiclesSubject.next(this.vehicles)}importBackup(e){try{const n=JSON.parse(e);return!(!Array.isArray(n)||!n.every(i=>i.hasOwnProperty("plate")&&i.hasOwnProperty("model"))||(this.processLoadedVehicles(n),this.saveVehicles(),0))}catch(n){return console.error("Error importing backup:",n),!1}}clearAllData(){this.vehicles=[],this.vehiclesSubject.next(this.vehicles),localStorage.removeItem(this.STORAGE_KEY)}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}saveVehicles(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.vehicles))}getVehicles(){return this.vehiclesSubject.asObservable()}addVehicle(e){const n=e.plate.toUpperCase();e.plate=n,0===this.vehicles.length&&(e.isDefault=!0),e.createdAt||(e.createdAt=Date.now()),this.vehicles.push({...e,supplies:[]}),this.vehiclesSubject.next(this.vehicles),this.saveVehicles()}setDefaultVehicle(e){const n=e.toUpperCase();let a=!1;this.vehicles.forEach(i=>{i.plate===n?i.isDefault||(i.isDefault=!0,a=!0):i.isDefault&&(i.isDefault=!1,a=!0)}),a&&(this.vehiclesSubject.next(this.vehicles),this.saveVehicles())}addConsumptionRecord(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);return!!i&&(i.consumptionHistory||(i.consumptionHistory=[]),n.id||(n.id=this.generateId()),n.createdAt||(n.createdAt=Date.now()),i.consumptionHistory.push(n),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0)}updateVehicle(e,n){const a=e.toUpperCase(),i=n.plate.toUpperCase();n.plate=i;const o=this.vehicles.findIndex(h=>h.plate===a);if(-1!==o){const h=this.vehicles[o].supplies||[];this.vehicles[o]={...n,supplies:h},this.vehiclesSubject.next(this.vehicles),this.saveVehicles()}}deleteVehicle(e){const n=e.toUpperCase(),a=this.vehicles.findIndex(i=>i.plate===n);-1!==a&&(this.vehicles.splice(a,1),this.vehiclesSubject.next(this.vehicles),this.saveVehicles())}addSupply(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);return i?(i.supplies||(i.supplies=[]),n.id||(n.id=this.generateId()),n.createdAt||(n.createdAt=Date.now()),i.supplies.push(n),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0):(console.error("Vehicle not found for plate:",a),!1)}addTrip(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);return i?(i.trips||(i.trips=[]),n.id||(n.id=this.generateId()),n.createdAt||(n.createdAt=Date.now()),i.trips.push(n),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0):(console.error("Vehicle not found for plate:",e),!1)}addMaintenance(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);return!!i&&(i.maintenance||(i.maintenance=[]),n.id||(n.id=this.generateId()),n.createdAt||(n.createdAt=Date.now()),i.maintenance.push(n),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0)}removerAbastecimento(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);if(i&&i.supplies){const o=i.supplies.findIndex(h=>h.id===n);if(-1!==o)return i.supplies.splice(o,1),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0}return!1}removerManutencao(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);if(i&&i.maintenance){const o=i.maintenance.findIndex(h=>h.id===n);if(-1!==o)return i.maintenance.splice(o,1),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0}return!1}updateSupply(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);if(i&&i.supplies){const o=i.supplies.findIndex(h=>h.id===n.id);if(-1!==o)return i.supplies[o]=n,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}updateMaintenance(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);if(i&&i.maintenance){const o=i.maintenance.findIndex(h=>h.id===n.id);if(-1!==o)return i.maintenance[o]=n,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}updateConsumptionRecord(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);if(i&&i.consumptionHistory){const o=i.consumptionHistory.findIndex(h=>h.id===n.id);if(-1!==o)return i.consumptionHistory[o]=n,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}updateTrip(e,n){const a=e.toUpperCase(),i=this.vehicles.find(o=>o.plate===a);if(i&&i.trips){const o=i.trips.findIndex(h=>h.id===n.id);if(-1!==o)return i.trips[o]=n,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}getVehicleTypeName(e){return{car:"Carro",motorcycle:"Moto",truck:"Caminh\xe3o",bus:"\xd4nibus",van:"Van"}[e]||e}getVehicleIcon(e){switch(e){case"car":default:return"car-sport-outline";case"motorcycle":return"moto-custom";case"truck":return"truck-heavy";case"bus":return"bus-outline";case"van":return"car-outline"}}}return(u=V).\u0275fac=function(e){return new(e||u)},u.\u0275prov=S.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),V})()}}]);