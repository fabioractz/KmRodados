"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5699],{5355(R,V,p){p.d(V,{k:()=>s});var f=p(467),C=p(7343),u=p(2200),h=p(2615),m=p(3664);let F=(()=>{var e;class n{}return(e=n).\u0275fac=function(r){return new(r||e)},e.\u0275cmp=m.VBU({type:e,selectors:[["app-ajuda-odometro-popover"]],decls:2,vars:0,consts:[[1,"conteudo-ajuda-odometro"]],template:function(r,_){1&r&&(m.rj2(0,"div",0),m.EFF(1," Od\xf4metro \xe9 o indicador que registra a quilometragem total do ve\xedculo desde zero. Voc\xea pode ver esse n\xfamero no painel, pr\xf3ximo ao veloc\xedmetro. "),m.eux())},dependencies:[u.MD,C.bv],encapsulation:2}),n})(),s=(()=>{var e;class n{constructor(r){this.controlador_popover=r}mostrarAjudaOdometro(r){var _=this;return(0,f.A)(function*(){yield(yield _.controlador_popover.create({component:F,event:r,side:"right",alignment:"center",showBackdrop:!1,cssClass:"popover-ajuda-odometro"})).present()})()}}return(e=n).\u0275fac=function(r){return new(r||e)(h.KVO(C.IE))},e.\u0275prov=h.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),n})()},5699(R,V,p){p.d(V,{CalculatorPageModule:()=>ie});var f=p(2200),C=p(4341),u=p(7343),h=p(8132),m=p(467),F=p(5079),s=p(5873),e=p(3664),n=p(2615),l=p(9198),r=p(6991),_=p(4007),T=p(5355);function S(c,d){if(1&c){const o=e.RV6();e.j41(0,"ion-buttons",8)(1,"ion-button",9),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setView("menu"))}),e.nrm(2,"ion-icon",10),e.k0s()()}}function G(c,d){if(1&c){const o=e.RV6();e.j41(0,"div",11)(1,"div",12),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setView("consumption"))}),e.nrm(2,"ion-icon",13),e.j41(3,"label"),e.EFF(4,"Calcular Consumo"),e.k0s()(),e.j41(5,"div",12),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setView("trip"))}),e.nrm(6,"ion-icon",14),e.j41(7,"label"),e.EFF(8,"Calcular Viagem"),e.k0s()(),e.j41(9,"div",12),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setView("simple"))}),e.nrm(10,"ion-icon",15),e.j41(11,"label"),e.EFF(12,"Calculadora"),e.k0s()()()}}function B(c,d){if(1&c&&(e.j41(0,"ion-select-option",28),e.EFF(1),e.nI1(2,"uppercase"),e.k0s()),2&c){const o=d.$implicit;e.Y8G("value",o),e.R7$(),e.Lme(" ",o.model," (",e.bMT(2,3,o.plate),") ")}}function w(c,d){if(1&c){const o=e.RV6();e.j41(0,"ion-datetime",29),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG(2);return e.DH7(a.tripDate,t)||(a.tripDate=t),n.Njj(t)}),e.k0s()}if(2&c){const o=e.XpG(2);e.R50("ngModel",o.tripDate)}}function X(c,d){if(1&c&&(e.j41(0,"ion-item")(1,"ion-label")(2,"p"),e.EFF(3,"Consumo do Ve\xedculo"),e.k0s(),e.j41(4,"h2"),e.EFF(5),e.k0s()()()),2&c){const o=e.XpG(2);e.R7$(5),e.SpI("",o.selectedVehicle.consumption," km/L")}}function A(c,d){if(1&c){const o=e.RV6();e.j41(0,"ion-card",30)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Resultado"),e.k0s()(),e.j41(4,"ion-card-content")(5,"h2"),e.EFF(6),e.nI1(7,"currency"),e.k0s(),e.j41(8,"p"),e.EFF(9),e.nI1(10,"number"),e.k0s(),e.j41(11,"ion-button",31),e.bIt("click",function(){n.eBV(o);const t=e.XpG(2);return n.Njj(t.saveTrip())}),e.EFF(12),e.k0s()()()}if(2&c){const o=e.XpG(2);e.R7$(6),e.SpI("Custo Estimado: ",e.i5U(7,3,o.result,"BRL")),e.R7$(3),e.SpI("Litros necess\xe1rios: ",e.i5U(10,6,o.litersNeeded,"1.1-2")," L"),e.R7$(3),e.SpI(" ",o.isEditing?"Atualizar Viagem":"Salvar Viagem"," ")}}function H(c,d){if(1&c){const o=e.RV6();e.j41(0,"div")(1,"div",16)(2,"p"),e.EFF(3,"Calcule quanto voc\xea vai gastar na sua viagem."),e.k0s()(),e.j41(4,"ion-list")(5,"ion-item")(6,"ion-select",17),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.selectedVehicle,t)||(a.selectedVehicle=t),n.Njj(t)}),e.bIt("ionChange",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.onVehicleChange())}),e.DNE(7,B,3,5,"ion-select-option",18),e.k0s()(),e.j41(8,"ion-item")(9,"ion-label",19),e.EFF(10,"Data"),e.k0s(),e.nrm(11,"ion-datetime-button",20),e.j41(12,"ion-modal",21),e.DNE(13,w,1,1,"ng-template"),e.k0s()(),e.j41(14,"ion-item")(15,"ion-input",22),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.distance,t)||(a.distance=t),n.Njj(t)}),e.k0s()(),e.j41(16,"ion-item")(17,"ion-input",23),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.fuelPriceStr,t)||(a.fuelPriceStr=t),n.Njj(t)}),e.bIt("ionInput",function(t){n.eBV(o);const a=e.XpG();return n.Njj(a.formatCurrency(t))}),e.k0s()(),e.j41(18,"ion-item")(19,"ion-textarea",24),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.costObservations,t)||(a.costObservations=t),n.Njj(t)}),e.k0s()(),e.DNE(20,X,6,1,"ion-item",6),e.k0s(),e.j41(21,"ion-button",25),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.calculate())}),e.EFF(22," Calcular Custo "),e.k0s(),e.j41(23,"ion-button",26),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setHistoryOpen(!0))}),e.EFF(24," Hist\xf3rico "),e.k0s(),e.DNE(25,A,13,9,"ion-card",27),e.k0s()}if(2&c){const o=e.XpG();e.R7$(6),e.R50("ngModel",o.selectedVehicle),e.R7$(),e.Y8G("ngForOf",o.vehicles),e.R7$(5),e.Y8G("keepContentsMounted",!0),e.R7$(3),e.R50("ngModel",o.distance),e.R7$(2),e.R50("ngModel",o.fuelPriceStr),e.R7$(2),e.R50("ngModel",o.costObservations),e.R7$(),e.Y8G("ngIf",o.selectedVehicle),e.R7$(5),e.Y8G("ngIf",null!==o.result)}}function $(c,d){if(1&c&&(e.j41(0,"ion-select-option",28),e.EFF(1),e.k0s()),2&c){const o=d.$implicit;e.Y8G("value",o.plate),e.R7$(),e.Lme("",o.model," (",o.plate,")")}}function U(c,d){if(1&c){const o=e.RV6();e.j41(0,"ion-datetime",40),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG(2);return e.DH7(a.calcDate,t)||(a.calcDate=t),n.Njj(t)}),e.k0s()}if(2&c){const o=e.XpG(2);e.R50("ngModel",o.calcDate)}}function L(c,d){if(1&c){const o=e.RV6();e.j41(0,"div")(1,"div",16)(2,"p"),e.EFF(3,"Descubra a m\xe9dia de consumo do seu ve\xedculo."),e.k0s()(),e.j41(4,"ion-list")(5,"ion-item")(6,"ion-select",32),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.calcSelectedVehicle,t)||(a.calcSelectedVehicle=t),n.Njj(t)}),e.DNE(7,$,2,3,"ion-select-option",18),e.k0s()(),e.j41(8,"ion-item")(9,"ion-label",19),e.EFF(10,"Data"),e.k0s(),e.nrm(11,"ion-datetime-button",33),e.j41(12,"ion-modal",21),e.DNE(13,U,1,1,"ng-template"),e.k0s()(),e.j41(14,"ion-item")(15,"ion-label",19),e.EFF(16," Od\xf4metro Inicial (km) "),e.j41(17,"span",34),e.bIt("click",function(t){n.eBV(o);const a=e.XpG();return n.Njj(a.ajuda_odometro.mostrarAjudaOdometro(t))}),e.EFF(18,"?"),e.k0s()(),e.j41(19,"ion-input",35),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.calcInitialOdometer,t)||(a.calcInitialOdometer=t),n.Njj(t)}),e.bIt("ionChange",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.updateDistance())}),e.k0s()(),e.j41(20,"ion-item")(21,"ion-label",19),e.EFF(22," Od\xf4metro Final (km) "),e.j41(23,"span",34),e.bIt("click",function(t){n.eBV(o);const a=e.XpG();return n.Njj(a.ajuda_odometro.mostrarAjudaOdometro(t))}),e.EFF(24,"?"),e.k0s()(),e.j41(25,"ion-input",35),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.calcFinalOdometer,t)||(a.calcFinalOdometer=t),n.Njj(t)}),e.bIt("ionChange",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.updateDistance())}),e.k0s()(),e.j41(26,"ion-item")(27,"ion-input",36),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.calcDist,t)||(a.calcDist=t),n.Njj(t)}),e.k0s()(),e.j41(28,"ion-item")(29,"ion-input",37),e.mxI("ngModelChange",function(t){n.eBV(o);const a=e.XpG();return e.DH7(a.calcLiters,t)||(a.calcLiters=t),n.Njj(t)}),e.bIt("ionChange",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.calculateConsumption())}),e.k0s()(),e.j41(30,"ion-item",38)(31,"ion-label")(32,"h2"),e.EFF(33,"M\xe9dia de Consumo"),e.k0s(),e.j41(34,"p",39),e.EFF(35),e.nI1(36,"number"),e.k0s()()()(),e.j41(37,"ion-button",25),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.saveConsumption())}),e.EFF(38," Salvar "),e.k0s(),e.j41(39,"ion-button",26),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setHistoryOpen(!0))}),e.EFF(40," Hist\xf3rico "),e.k0s()()}if(2&c){const o=e.XpG();e.R7$(6),e.R50("ngModel",o.calcSelectedVehicle),e.R7$(),e.Y8G("ngForOf",o.vehicles),e.R7$(5),e.Y8G("keepContentsMounted",!0),e.R7$(7),e.R50("ngModel",o.calcInitialOdometer),e.R7$(6),e.R50("ngModel",o.calcFinalOdometer),e.R7$(2),e.R50("ngModel",o.calcDist),e.R7$(2),e.R50("ngModel",o.calcLiters),e.R7$(6),e.SpI(" ",o.calcResult?e.i5U(36,8,o.calcResult,"1.2-2")+" km/l":"--"," ")}}function z(c,d){if(1&c){const o=e.RV6();e.j41(0,"div")(1,"div",41)(2,"div",42),e.EFF(3),e.k0s(),e.j41(4,"div",43)(5,"ion-button",44),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.clearCalculator())}),e.EFF(6,"C"),e.k0s(),e.j41(7,"ion-button",44),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.backspace())}),e.nrm(8,"ion-icon",45),e.k0s(),e.j41(9,"ion-button",44),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.percentage())}),e.EFF(10,"%"),e.k0s(),e.j41(11,"ion-button",46),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setOperation("/"))}),e.EFF(12,"/"),e.k0s(),e.j41(13,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("7"))}),e.EFF(14,"7"),e.k0s(),e.j41(15,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("8"))}),e.EFF(16,"8"),e.k0s(),e.j41(17,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("9"))}),e.EFF(18,"9"),e.k0s(),e.j41(19,"ion-button",46),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setOperation("*"))}),e.EFF(20,"x"),e.k0s(),e.j41(21,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("4"))}),e.EFF(22,"4"),e.k0s(),e.j41(23,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("5"))}),e.EFF(24,"5"),e.k0s(),e.j41(25,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("6"))}),e.EFF(26,"6"),e.k0s(),e.j41(27,"ion-button",46),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setOperation("-"))}),e.EFF(28,"-"),e.k0s(),e.j41(29,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("1"))}),e.EFF(30,"1"),e.k0s(),e.j41(31,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("2"))}),e.EFF(32,"2"),e.k0s(),e.j41(33,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("3"))}),e.EFF(34,"3"),e.k0s(),e.j41(35,"ion-button",46),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setOperation("+"))}),e.EFF(36,"+"),e.k0s(),e.j41(37,"ion-button",48),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("0"))}),e.EFF(38,"0"),e.k0s(),e.j41(39,"ion-button",47),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.appendNumber("."))}),e.EFF(40,"."),e.k0s(),e.j41(41,"ion-button",46),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.calculateResult())}),e.EFF(42,"="),e.k0s()()()()}if(2&c){const o=e.XpG();e.R7$(3),e.JRh(o.calcDisplay)}}function Y(c,d){if(1&c){const o=e.RV6();e.j41(0,"ion-item")(1,"ion-label")(2,"h2"),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()(),e.j41(9,"ion-note",52),e.EFF(10),e.nI1(11,"currency"),e.k0s(),e.j41(12,"ion-button",53),e.bIt("click",function(){const t=n.eBV(o).$implicit,a=e.XpG(3);return n.Njj(a.editHistoryItem(t))}),e.nrm(13,"ion-icon",54),e.k0s()()}if(2&c){const o=d.$implicit;e.R7$(3),e.Lme("",e.i5U(4,5,o.trip.date,"dd/MM/yyyy")," - ",o.vehicle.model),e.R7$(3),e.SpI("Dist\xe2ncia: ",o.trip.distance," km"),e.R7$(2),e.SpI("Consumo: ",o.trip.consumption," km/L"),e.R7$(2),e.SpI(" ",e.i5U(11,8,o.trip.totalCost,"BRL")," ")}}function K(c,d){1&c&&(e.j41(0,"div",55)(1,"p"),e.EFF(2,"Nenhuma viagem registrada."),e.k0s()())}function W(c,d){if(1&c&&(e.j41(0,"ion-list"),e.DNE(1,Y,14,11,"ion-item",50)(2,K,3,0,"div",51),e.k0s()),2&c){const o=e.XpG(2);e.R7$(),e.Y8G("ngForOf",o.tripHistory),e.R7$(),e.Y8G("ngIf",0===o.tripHistory.length)}}function J(c,d){if(1&c&&(e.j41(0,"ion-item")(1,"ion-label")(2,"h2"),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()(),e.j41(9,"ion-note",56),e.EFF(10),e.nI1(11,"number"),e.k0s()()),2&c){const o=d.$implicit;e.R7$(3),e.Lme("",e.i5U(4,5,o.record.date,"dd/MM/yyyy")," - ",o.vehicle.model),e.R7$(3),e.SpI("Dist\xe2ncia: ",o.record.distance," km"),e.R7$(2),e.SpI("Litros: ",o.record.liters," L"),e.R7$(2),e.SpI(" ",e.i5U(11,8,o.record.result,"1.2-2")," km/L ")}}function Q(c,d){1&c&&(e.j41(0,"div",55)(1,"p"),e.EFF(2,"Nenhum consumo registrado."),e.k0s()())}function Z(c,d){if(1&c&&(e.j41(0,"ion-list"),e.DNE(1,J,12,11,"ion-item",50)(2,Q,3,0,"div",51),e.k0s()),2&c){const o=e.XpG(2);e.R7$(),e.Y8G("ngForOf",o.consumptionHistory),e.R7$(),e.Y8G("ngIf",0===o.consumptionHistory.length)}}function q(c,d){if(1&c){const o=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",49)(5,"ion-button",9),e.bIt("click",function(){n.eBV(o);const t=e.XpG();return n.Njj(t.setHistoryOpen(!1))}),e.EFF(6,"Fechar"),e.k0s()()()(),e.j41(7,"ion-content"),e.DNE(8,W,3,2,"ion-list",6)(9,Z,3,2,"ion-list",6),e.k0s()}if(2&c){const o=e.XpG();e.R7$(3),e.JRh("trip"===o.currentView?"Hist\xf3rico de Viagens":"Hist\xf3rico de Consumo"),e.R7$(5),e.Y8G("ngIf","trip"===o.currentView),e.R7$(),e.Y8G("ngIf","consumption"===o.currentView)}}const ee=[{path:"",component:(()=>{var c;class d{constructor(i,t,a,g,v,I){this.vehicleService=i,this.alertCtrl=t,this.toastCtrl=a,this.route=g,this.ads=v,this.ajuda_odometro=I,this.currentView="menu",this.vehicles=[],this.selectedVehicle=null,this.distance=null,this.fuelPrice=null,this.fuelPriceStr="",this.costObservations="",this.result=null,this.litersNeeded=null,this.calcSelectedVehicle="",this.calcDate="",this.calcInitialOdometer=null,this.calcFinalOdometer=null,this.calcDist=null,this.calcLiters=null,this.calcResult=null,this.isHistoryOpen=!1,this.isEditing=!1,this.editingId=void 0,this.tripDate=(new Date).toISOString(),this.placa_padrao_atual=null,this.placa_parametro=null,this.calcDisplay="0",this.currentInput="",this.previousInput="",this.operation=null,this.shouldResetDisplay=!1,(0,F.a)({backspaceOutline:s.GvW,create:s.vtF,speedometerOutline:s.MrY,carOutline:s.hsd,calculatorOutline:s.N0h,arrowBackOutline:s.hGB,mapOutline:s.dG8})}ngOnInit(){this.initDate(),this.ads.preloadInterstitial(),this.route.queryParams.subscribe(i=>{i&&i.plate&&(this.placa_parametro=i.plate)}),this.vehicleService.getVehicles().subscribe(i=>{let t;this.vehicles=i,this.placa_parametro&&(t=this.vehicles.find(v=>v.plate===this.placa_parametro));const a=this.vehicles.find(v=>v.isDefault)||null,g=a?a.plate:null;if(t&&!this.selectedVehicle&&(this.selectedVehicle=t,this.calcSelectedVehicle||(this.calcSelectedVehicle=t.plate)),g&&g!==this.placa_padrao_atual&&(this.placa_padrao_atual=g,this.placa_parametro||(this.selectedVehicle=a,this.calcSelectedVehicle=g)),!this.selectedVehicle&&this.vehicles.length>0){const v=this.vehicles[0];this.selectedVehicle=v,this.calcSelectedVehicle||(this.calcSelectedVehicle=v.plate)}else!this.calcSelectedVehicle&&this.selectedVehicle&&(this.calcSelectedVehicle=this.selectedVehicle.plate)})}initDate(){const i=new Date,t=6e4*i.getTimezoneOffset(),a=new Date(i.getTime()-t).toISOString();this.calcDate=a,this.tripDate=a}setView(i){this.currentView=i}updateDistance(){null!==this.calcInitialOdometer&&null!==this.calcFinalOdometer&&(this.calcDist=this.calcFinalOdometer-this.calcInitialOdometer),this.calculateConsumption()}calculateConsumption(){this.calcResult=this.calcDist&&this.calcLiters&&this.calcLiters>0?this.calcDist/this.calcLiters:null}saveConsumption(){var i=this;return(0,m.A)(function*(){var t,a;if(!(i.calcSelectedVehicle&&i.calcResult&&i.calcDist&&i.calcLiters))return void(yield(yield i.alertCtrl.create({header:"Campos Obrigat\xf3rios",message:"Por favor, selecione um ve\xedculo e certifique-se que o c\xe1lculo foi realizado.",buttons:["OK"]})).present());const g={date:new Date,initialOdometer:null!==(t=i.calcInitialOdometer)&&void 0!==t?t:void 0,finalOdometer:null!==(a=i.calcFinalOdometer)&&void 0!==a?a:void 0,distance:i.calcDist,liters:i.calcLiters,result:i.calcResult};if(i.vehicleService.addConsumptionRecord(i.calcSelectedVehicle,g)){yield(yield i.toastCtrl.create({message:"C\xe1lculo salvo com sucesso!",duration:2e3,position:"bottom",color:"success"})).present();const j=yield i.ads.showInterstitialWithResult();if(!j.ok||!j.shown){if("throttled"===j.reason)return;const b=i.ads.obterDiagnostico(),y="reason=".concat(j.reason||"unknown","; error=").concat(j.error||"","; adId=").concat(b.adId,"; testMode=").concat(b.testMode,"; plataforma=").concat(b.plataforma).concat(b.ultimoErro?"; ultimoErro="+b.ultimoErro:"").concat(b.diagnosticoAtivo?"; diagnosticoAtivo=true":"");yield(yield i.alertCtrl.create({header:"Falha ao exibir an\xfancio",message:"N\xe3o foi poss\xedvel exibir o an\xfancio agora.",buttons:[{text:"Copiar",handler:(k=(0,m.A)(function*(){try{var x;yield null===(x=navigator.clipboard)||void 0===x?void 0:x.writeText(y)}catch{try{var E,D;null===(E=(D=window).prompt)||void 0===E||E.call(D,"Copiar detalhes do erro:",y)}catch{}}}),function(){return k.apply(this,arguments)})},{text:"OK",role:"cancel"}]})).present()}i.calcInitialOdometer=null,i.calcFinalOdometer=null,i.calcDist=null,i.calcLiters=null,i.calcResult=null}var k})()}onVehicleChange(){this.isEditing||(this.result=null,this.litersNeeded=null)}calculate(){this.fuelPrice=this.parseCurrency(this.fuelPriceStr),this.selectedVehicle&&this.distance&&this.fuelPrice&&this.selectedVehicle.consumption?(this.litersNeeded=this.distance/this.selectedVehicle.consumption,this.result=this.litersNeeded*this.fuelPrice):alert("Por favor, preencha todos os campos e certifique-se que o ve\xedculo tem consumo cadastrado.")}saveTrip(){var i=this;return(0,m.A)(function*(){if(i.fuelPrice=i.parseCurrency(i.fuelPriceStr),!(i.selectedVehicle&&i.result&&i.distance&&i.fuelPrice))return void(yield(yield i.alertCtrl.create({header:"Aten\xe7\xe3o",message:"Calcule o custo antes de salvar.",buttons:["OK"]})).present());const t=i.tripDate.split("T")[0],[a,g,v]=t.split("-").map(Number),I=new Date(a,g-1,v),j={id:i.isEditing?i.editingId:void 0,date:I,distance:i.distance,consumption:i.selectedVehicle.consumption||0,fuelPrice:i.fuelPrice,totalCost:i.result,createdAt:Date.now()};let b=!1;if(b=i.isEditing?i.vehicleService.updateTrip(i.selectedVehicle.plate,j):i.vehicleService.addTrip(i.selectedVehicle.plate,j),b){yield(yield i.toastCtrl.create({message:i.isEditing?"Viagem atualizada com sucesso!":"Viagem salva no hist\xf3rico!",duration:2e3,position:"bottom",color:"success"})).present();const P=yield i.ads.showInterstitialWithResult();if(!P.ok||!P.shown){if("throttled"===P.reason)return;const k=i.ads.obterDiagnostico(),x="reason=".concat(P.reason||"unknown","; error=").concat(P.error||"","; adId=").concat(k.adId,"; testMode=").concat(k.testMode,"; plataforma=").concat(k.plataforma).concat(k.ultimoErro?"; ultimoErro="+k.ultimoErro:"").concat(k.diagnosticoAtivo?"; diagnosticoAtivo=true":"");yield(yield i.alertCtrl.create({header:"Falha ao exibir an\xfancio",message:"N\xe3o foi poss\xedvel exibir o an\xfancio agora.",buttons:[{text:"Copiar",handler:(D=(0,m.A)(function*(){try{var O;yield null===(O=navigator.clipboard)||void 0===O?void 0:O.writeText(x)}catch{try{var M,N;null===(M=(N=window).prompt)||void 0===M||M.call(N,"Copiar detalhes do erro:",x)}catch{}}}),function(){return D.apply(this,arguments)})},{text:"OK",role:"cancel"}]})).present()}i.clearForm(),i.setHistoryOpen(!1)}var D})()}clearForm(){this.distance=null,this.fuelPrice=null,this.fuelPriceStr="",this.costObservations="",this.result=null,this.litersNeeded=null,this.isEditing=!1,this.editingId=void 0}get tripHistory(){const i=[];return this.vehicles.forEach(t=>{t.trips&&t.trips.forEach(a=>{i.push({vehicle:t,trip:a})})}),i.sort((t,a)=>new Date(a.trip.date).getTime()-new Date(t.trip.date).getTime())}get consumptionHistory(){const i=[];return this.vehicles.forEach(t=>{t.consumptionHistory&&t.consumptionHistory.forEach(a=>{i.push({vehicle:t,record:a})})}),i.sort((t,a)=>new Date(a.record.date).getTime()-new Date(t.record.date).getTime())}setHistoryOpen(i){this.isHistoryOpen=i,i||(this.isEditing=!1,this.editingId=void 0)}editHistoryItem(i){this.isHistoryOpen=!1,this.isEditing=!0,this.editingId=i.trip.id,this.selectedVehicle=this.vehicles.find(g=>g.plate===i.vehicle.plate)||null;const t=new Date(i.trip.date),a=6e4*t.getTimezoneOffset();this.tripDate=new Date(t.getTime()-a).toISOString(),this.distance=i.trip.distance,this.fuelPrice=i.trip.fuelPrice,this.fuelPriceStr=this.fuelPrice?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(this.fuelPrice):"",this.result=i.trip.totalCost,this.selectedVehicle&&this.selectedVehicle.consumption&&(this.litersNeeded=this.distance/this.selectedVehicle.consumption)}formatCurrency(i){let t=i.target.value;if(t=t.replace(/\D/g,""),""===t)return void(this.fuelPriceStr="");const a=parseInt(t,10)/100;this.fuelPriceStr=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)}parseCurrency(i){if(!i)return null;const t=i.replace(/[^\d,]/g,"").replace(",",".");return parseFloat(t)}appendNumber(i){this.shouldResetDisplay&&(this.calcDisplay="",this.shouldResetDisplay=!1),"0"===this.calcDisplay&&"."!==i?this.calcDisplay=i:this.calcDisplay+=i}backspace(){this.calcDisplay=this.calcDisplay.length>1?this.calcDisplay.slice(0,-1):"0"}percentage(){const i=parseFloat(this.calcDisplay);this.calcDisplay=(i/100).toString(),this.shouldResetDisplay=!0}setOperation(i){null!==this.operation&&this.calculateResult(),this.previousInput=this.calcDisplay,this.operation=i,this.shouldResetDisplay=!0}calculateResult(){if(null===this.operation||this.shouldResetDisplay)return;const i=parseFloat(this.previousInput),t=parseFloat(this.calcDisplay);let a=0;switch(this.operation){case"+":a=i+t;break;case"-":a=i-t;break;case"*":a=i*t;break;case"/":a=i/t}this.calcDisplay=a.toString(),this.operation=null,this.shouldResetDisplay=!0}clearCalculator(){this.calcDisplay="0",this.currentInput="",this.previousInput="",this.operation=null,this.shouldResetDisplay=!1}}return(c=d).\u0275fac=function(i){return new(i||c)(e.rXU(l.K),e.rXU(u.hG),e.rXU(u.K_),e.rXU(r.nX),e.rXU(_.g),e.rXU(T.k))},c.\u0275cmp=e.VBU({type:c,selectors:[["app-calculator"]],standalone:!1,decls:16,vars:10,consts:[[3,"translucent"],["slot","start",4,"ngIf"],[1,"ion-padding",3,"fullscreen"],["collapse","condense"],["size","large"],["class","menu-container",4,"ngIf"],[4,"ngIf"],[3,"didDismiss","isOpen"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"menu-container"],[1,"menu-button",3,"click"],["name","speedometer-outline"],["name","map-outline"],["name","calculator-outline"],[1,"ion-padding-bottom"],["label","Selecione o Ve\xedculo","label-placement","floating","placeholder","Escolha um ve\xedculo",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["position","stacked"],["datetime","trip-datetime"],[3,"keepContentsMounted"],["label","Dist\xe2ncia (km)","type","number","inputmode","numeric","label-placement","floating","placeholder","Ex: 150",3,"ngModelChange","ngModel"],["label","Pre\xe7o do Combust\xedvel (R$)","type","tel","inputmode","decimal","label-placement","floating","placeholder","R$ 0,00",3,"ngModelChange","ionInput","ngModel"],["label","Observa\xe7\xf5es","label-placement","floating","placeholder","Opcional","rows","3",3,"ngModelChange","ngModel"],["expand","block",1,"ion-margin-top",3,"click"],["expand","block","fill","outline",1,"ion-margin-top",3,"click"],["class","ion-margin-top",4,"ngIf"],[3,"value"],["id","trip-datetime","presentation","date","locale","pt-BR",3,"ngModelChange","ngModel"],[1,"ion-margin-top"],["expand","block","color","success",1,"ion-margin-top",3,"click"],["label","Ve\xedculo","label-placement","stacked",3,"ngModelChange","ngModel"],["datetime","calc-consumption-datetime"],["tabindex","0",1,"icone-ajuda-odometro",3,"click"],["type","number","inputmode","numeric",3,"ngModelChange","ionChange","ngModel"],["type","number","inputmode","numeric","label","Dist\xe2ncia Percorrida (km)","label-placement","stacked","readonly","",3,"ngModelChange","ngModel"],["type","number","inputmode","decimal","label","Litros Abastecidos","label-placement","stacked",3,"ngModelChange","ionChange","ngModel"],["lines","none"],[2,"font-size","24px","font-weight","bold","color","var(--ion-color-primary)"],["id","calc-consumption-datetime","presentation","date","locale","pt-BR",3,"ngModelChange","ngModel"],[1,"calculator-container","ion-margin-top"],[1,"calc-display"],[1,"calc-grid"],["color","primary","fill","outline",3,"click"],["name","backspace-outline"],["color","primary",3,"click"],["color","light",3,"click"],["color","light",1,"double-col",3,"click"],["slot","end"],[4,"ngFor","ngForOf"],["class","ion-padding ion-text-center",4,"ngIf"],["slot","end","color","success",2,"font-size","1.1em","font-weight","bold"],["slot","end","fill","clear",3,"click"],["name","create","slot","icon-only"],[1,"ion-padding","ion-text-center"],["slot","end","color","primary",2,"font-size","1.1em","font-weight","bold"]],template:function(i,t){1&i&&(e.j41(0,"ion-header",0)(1,"ion-toolbar"),e.DNE(2,S,3,0,"ion-buttons",1),e.j41(3,"ion-title"),e.EFF(4),e.k0s()()(),e.j41(5,"ion-content",2)(6,"ion-header",3)(7,"ion-toolbar")(8,"ion-title",4),e.EFF(9),e.k0s()()(),e.DNE(10,G,13,0,"div",5)(11,H,26,8,"div",6)(12,L,41,11,"div",6)(13,z,43,1,"div",6),e.j41(14,"ion-modal",7),e.bIt("didDismiss",function(){return t.setHistoryOpen(!1)}),e.DNE(15,q,10,3,"ng-template"),e.k0s()()),2&i&&(e.Y8G("translucent",!0),e.R7$(2),e.Y8G("ngIf","menu"!==t.currentView),e.R7$(2),e.SpI(" ","menu"===t.currentView?"Calcular":"trip"===t.currentView?"Calcular Viagem":"consumption"===t.currentView?"Calcular Consumo":"Calculadora"," "),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(4),e.SpI(" ","menu"===t.currentView?"Calcular":"trip"===t.currentView?"Calcular Viagem":"consumption"===t.currentView?"Calcular Consumo":"Calculadora"," "),e.R7$(),e.Y8G("ngIf","menu"===t.currentView),e.R7$(),e.Y8G("ngIf","trip"===t.currentView),e.R7$(),e.Y8G("ngIf","consumption"===t.currentView),e.R7$(),e.Y8G("ngIf","simple"===t.currentView),e.R7$(),e.Y8G("isOpen",t.isHistoryOpen))},dependencies:[f.Sq,f.bT,C.BC,C.vS,u.Jm,u.QW,u.b_,u.I9,u.ME,u.tN,u.W9,u.A9,u.K4,u.eU,u.iq,u.$w,u.uz,u.he,u.nf,u.JI,u.Nm,u.Ip,u.nc,u.BC,u.ai,u.Sb,u.su,u.Je,u.Gw,f.Pc,f.QX,f.oe,f.vh],styles:[".calculator-container[_ngcontent-%COMP%]{background:var(--ion-color-step-50, #f4f5f8);background:var(--ion-card-background, #fff);background:linear-gradient(145deg,var(--ion-color-step-100, #e6e6e6),var(--ion-color-step-50, #ffffff));padding:15px;border-radius:20px;box-shadow:0 5px 15px #0000001a,inset 0 1px 1px #fff6;max-width:280px;margin:20px auto;border:1px solid var(--ion-color-step-150, rgba(0, 0, 0, .05))}@media (prefers-color-scheme: dark){.calculator-container[_ngcontent-%COMP%]{background:linear-gradient(145deg,#2b2d31,#1e2023);box-shadow:0 10px 20px #0006,inset 0 1px 1px #ffffff1a;border:1px solid rgba(255,255,255,.05)}}body.dark[_nghost-%COMP%]   .calculator-container[_ngcontent-%COMP%], body.dark   [_nghost-%COMP%]   .calculator-container[_ngcontent-%COMP%]{background:linear-gradient(145deg,#2b2d31,#1e2023);box-shadow:0 10px 20px #0006,inset 0 1px 1px #ffffff1a;border:1px solid rgba(255,255,255,.05)}.calc-display[_ngcontent-%COMP%]{background:var(--ion-color-step-100, rgba(0, 0, 0, .05));color:var(--ion-text-color, #000);font-size:2.5rem;font-weight:300;text-align:right;padding:15px 20px;border-radius:12px;margin-bottom:20px;overflow-x:auto;white-space:nowrap;box-shadow:inset 0 2px 5px #0000000d;border:1px solid var(--ion-color-step-200, rgba(0, 0, 0, .05))}.calc-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}.calc-grid[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;height:50px;margin:0;font-size:1.2rem;font-weight:500;--box-shadow: 0 4px 6px rgba(0,0,0,.1);transition:transform .1s}.calc-grid[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.calc-grid[_ngcontent-%COMP%]   ion-button[color=light][_ngcontent-%COMP%]{--background: var(--ion-color-step-50, #fff);--color: var(--ion-text-color, #333);--background-activated: var(--ion-color-step-150, #f0f0f0)}.calc-grid[_ngcontent-%COMP%]   ion-button[color=primary][_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast);font-weight:600}.calc-grid[_ngcontent-%COMP%]   ion-button[color=primary][_ngcontent-%COMP%]:last-child{--background: var(--ion-color-success)}.calc-grid[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]{--border-color: var(--ion-color-medium);--color: var(--ion-color-medium);--border-width: 1px}.double-col[_ngcontent-%COMP%]{grid-column:span 2}.menu-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px;justify-content:center;align-items:stretch;min-height:60vh}.menu-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--ion-card-background, #fff);border-radius:20px;padding:14px 18px;box-shadow:0 8px 20px #0000001f;cursor:pointer;transition:transform .2s cubic-bezier(.25,.8,.25,1);width:100%;height:auto}.menu-button[_ngcontent-%COMP%]:active{transform:scale(.95);background:var(--ion-color-step-50, #f9f9f9);box-shadow:0 4px 10px #0000001a}.menu-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:15px;margin-right:0;color:var(--ion-color-primary)}.menu-button[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;text-align:center;color:var(--ion-text-color);line-height:1.3}"]}),d})()}];let te=(()=>{var c;class d{}return(c=d).\u0275fac=function(i){return new(i||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=n.G2t({imports:[h.iI.forChild(ee),h.iI]}),d})(),ie=(()=>{var c;class d{}return(c=d).\u0275fac=function(i){return new(i||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=n.G2t({imports:[f.MD,C.YN,u.bv,te]}),d})()},9198(R,V,p){p.d(V,{K:()=>u});var f=p(4412),C=p(2615);let u=(()=>{var h;class m{constructor(){this.vehicles=[],this.vehiclesSubject=new f.t([]),this.STORAGE_KEY="kmrodados_vehicles",this.loadVehicles()}loadVehicles(){const s=localStorage.getItem(this.STORAGE_KEY);s&&this.processLoadedVehicles(JSON.parse(s))}processLoadedVehicles(s){this.vehicles=s.map(e=>({...e,plate:e.plate?e.plate.toUpperCase():e.plate})),this.vehicles.forEach(e=>{e.supplies&&e.supplies.forEach(n=>{n.date=new Date(n.date),n.id||(n.id=this.generateId())}),e.consumptionHistory&&e.consumptionHistory.forEach(n=>{n.date=new Date(n.date),n.id||(n.id=this.generateId())}),e.maintenance&&e.maintenance.forEach(n=>{n.date=new Date(n.date),n.id||(n.id=this.generateId())})}),this.vehiclesSubject.next(this.vehicles)}importBackup(s){try{const e=JSON.parse(s);return!(!Array.isArray(e)||!e.every(l=>l.hasOwnProperty("plate")&&l.hasOwnProperty("model"))||(this.processLoadedVehicles(e),this.saveVehicles(),0))}catch(e){return console.error("Error importing backup:",e),!1}}clearAllData(){this.vehicles=[],this.vehiclesSubject.next(this.vehicles),localStorage.removeItem(this.STORAGE_KEY)}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}saveVehicles(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.vehicles))}getVehicles(){return this.vehiclesSubject.asObservable()}addVehicle(s){const e=s.plate.toUpperCase();s.plate=e,0===this.vehicles.length&&(s.isDefault=!0),s.createdAt||(s.createdAt=Date.now()),this.vehicles.push({...s,supplies:[]}),this.vehiclesSubject.next(this.vehicles),this.saveVehicles()}setDefaultVehicle(s){const e=s.toUpperCase();let n=!1;this.vehicles.forEach(l=>{l.plate===e?l.isDefault||(l.isDefault=!0,n=!0):l.isDefault&&(l.isDefault=!1,n=!0)}),n&&(this.vehiclesSubject.next(this.vehicles),this.saveVehicles())}addConsumptionRecord(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);return!!l&&(l.consumptionHistory||(l.consumptionHistory=[]),e.id||(e.id=this.generateId()),e.createdAt||(e.createdAt=Date.now()),l.consumptionHistory.push(e),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0)}updateVehicle(s,e){const n=s.toUpperCase(),l=e.plate.toUpperCase();e.plate=l;const r=this.vehicles.findIndex(_=>_.plate===n);if(-1!==r){const _=this.vehicles[r].supplies||[];this.vehicles[r]={...e,supplies:_},this.vehiclesSubject.next(this.vehicles),this.saveVehicles()}}deleteVehicle(s){const e=s.toUpperCase(),n=this.vehicles.findIndex(l=>l.plate===e);-1!==n&&(this.vehicles.splice(n,1),this.vehiclesSubject.next(this.vehicles),this.saveVehicles())}addSupply(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);return l?(l.supplies||(l.supplies=[]),e.id||(e.id=this.generateId()),e.createdAt||(e.createdAt=Date.now()),l.supplies.push(e),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0):(console.error("Vehicle not found for plate:",n),!1)}addTrip(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);return l?(l.trips||(l.trips=[]),e.id||(e.id=this.generateId()),e.createdAt||(e.createdAt=Date.now()),l.trips.push(e),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0):(console.error("Vehicle not found for plate:",s),!1)}addMaintenance(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);return!!l&&(l.maintenance||(l.maintenance=[]),e.id||(e.id=this.generateId()),e.createdAt||(e.createdAt=Date.now()),l.maintenance.push(e),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0)}removerAbastecimento(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);if(l&&l.supplies){const r=l.supplies.findIndex(_=>_.id===e);if(-1!==r)return l.supplies.splice(r,1),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0}return!1}removerManutencao(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);if(l&&l.maintenance){const r=l.maintenance.findIndex(_=>_.id===e);if(-1!==r)return l.maintenance.splice(r,1),this.vehiclesSubject.next([...this.vehicles]),this.saveVehicles(),!0}return!1}updateSupply(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);if(l&&l.supplies){const r=l.supplies.findIndex(_=>_.id===e.id);if(-1!==r)return l.supplies[r]=e,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}updateMaintenance(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);if(l&&l.maintenance){const r=l.maintenance.findIndex(_=>_.id===e.id);if(-1!==r)return l.maintenance[r]=e,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}updateConsumptionRecord(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);if(l&&l.consumptionHistory){const r=l.consumptionHistory.findIndex(_=>_.id===e.id);if(-1!==r)return l.consumptionHistory[r]=e,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}updateTrip(s,e){const n=s.toUpperCase(),l=this.vehicles.find(r=>r.plate===n);if(l&&l.trips){const r=l.trips.findIndex(_=>_.id===e.id);if(-1!==r)return l.trips[r]=e,this.vehiclesSubject.next(this.vehicles),this.saveVehicles(),!0}return!1}getVehicleTypeName(s){return{car:"Carro",motorcycle:"Moto",truck:"Caminh\xe3o",bus:"\xd4nibus",van:"Van"}[s]||s}getVehicleIcon(s){switch(s){case"car":default:return"car-sport-outline";case"motorcycle":return"moto-custom";case"truck":return"truck-heavy";case"bus":return"bus-outline";case"van":return"car-outline"}}}return(h=m).\u0275fac=function(s){return new(s||h)},h.\u0275prov=C.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),m})()}}]);